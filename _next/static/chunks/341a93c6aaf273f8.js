(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20955,(e,t,r)=>{var n={229:function(e){var t,r,n,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:l}catch(e){r=l}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}var o=[],c=!1,u=-1;function d(){c&&n&&(c=!1,n.length?o=n.concat(o):u=-1,o.length&&h())}function h(){if(!c){var e=i(d);c=!0;for(var t=o.length;t;){for(n=o,o=[];++u<t;)n&&n[u].run();u=-1,t=o.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===l||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.push(new m(e,t)),1!==o.length||c||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},s={};function a(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}},l=!0;try{n[e](r,r.exports,a),l=!1}finally{l&&delete s[e]}return r.exports}a.ab="/ROOT/node_modules/next/dist/compiled/process/",t.exports=a(229)},50461,(e,t,r)=>{"use strict";var n,s;t.exports=(null==(n=e.g.process)?void 0:n.env)&&"object"==typeof(null==(s=e.g.process)?void 0:s.env)?e.g.process:e.r(20955)},8481,(e,t,r)=>{"use strict";var n=Symbol.for("react.transitional.element");function s(e,t,r){var s=null;if(void 0!==r&&(s=""+r),void 0!==t.key&&(s=""+t.key),"key"in t)for(var a in r={},t)"key"!==a&&(r[a]=t[a]);else r=t;return{$$typeof:n,type:e,key:s,ref:void 0!==(t=r.ref)?t:null,props:r}}r.Fragment=Symbol.for("react.fragment"),r.jsx=s,r.jsxs=s},91398,(e,t,r)=>{"use strict";t.exports=e.r(8481)},61556,(e,t,r)=>{"use strict";var n=e.i(50461),s=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),x=Symbol.iterator,p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,y={};function v(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||p}function w(){}function j(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=v.prototype;var N=j.prototype=new w;N.constructor=j,b(N,v.prototype),N.isPureReactComponent=!0;var E=Array.isArray;function S(){}var k={H:null,A:null,T:null,S:null},_=Object.prototype.hasOwnProperty;function C(e,t,r){var n=r.ref;return{$$typeof:s,type:e,key:t,ref:void 0!==n?n:null,props:r}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===s}var L=/\/+/g;function O(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function M(e,t,r){if(null==e)return e;var n=[],l=0;return!function e(t,r,n,l,i){var o,c,u,d=typeof t;("undefined"===d||"boolean"===d)&&(t=null);var h=!1;if(null===t)h=!0;else switch(d){case"bigint":case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case s:case a:h=!0;break;case f:return e((h=t._init)(t._payload),r,n,l,i)}}if(h)return i=i(t),h=""===l?"."+O(t,0):l,E(i)?(n="",null!=h&&(n=h.replace(L,"$&/")+"/"),e(i,r,n,"",function(e){return e})):null!=i&&(T(i)&&(o=i,c=n+(null==i.key||t&&t.key===i.key?"":(""+i.key).replace(L,"$&/")+"/")+h,i=C(o.type,c,o.props)),r.push(i)),1;h=0;var m=""===l?".":l+":";if(E(t))for(var g=0;g<t.length;g++)d=m+O(l=t[g],g),h+=e(l,r,n,d,i);else if("function"==typeof(g=null===(u=t)||"object"!=typeof u?null:"function"==typeof(u=x&&u[x]||u["@@iterator"])?u:null))for(t=g.call(t),g=0;!(l=t.next()).done;)d=m+O(l=l.value,g++),h+=e(l,r,n,d,i);else if("object"===d){if("function"==typeof t.then)return e(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(S,S):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(t),r,n,l,i);throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(r=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.")}return h}(e,n,"","",function(e){return t.call(r,e,l++)}),n}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof n.default&&"function"==typeof n.default.emit)return void n.default.emit("uncaughtException",e);console.error(e)};r.Activity=g,r.Children={map:M,forEach:function(e,t,r){M(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return M(e,function(){t++}),t},toArray:function(e){return M(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},r.Component=v,r.Fragment=l,r.Profiler=o,r.PureComponent=j,r.StrictMode=i,r.Suspense=h,r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,r.__COMPILER_RUNTIME={__proto__:null,c:function(e){return k.H.useMemoCache(e)}},r.cache=function(e){return function(){return e.apply(null,arguments)}},r.cacheSignal=function(){return null},r.cloneElement=function(e,t,r){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var n=b({},e.props),s=e.key;if(null!=t)for(a in void 0!==t.key&&(s=""+t.key),t)_.call(t,a)&&"key"!==a&&"__self"!==a&&"__source"!==a&&("ref"!==a||void 0!==t.ref)&&(n[a]=t[a]);var a=arguments.length-2;if(1===a)n.children=r;else if(1<a){for(var l=Array(a),i=0;i<a;i++)l[i]=arguments[i+2];n.children=l}return C(e.type,s,n)},r.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:c,_context:e},e},r.createElement=function(e,t,r){var n,s={},a=null;if(null!=t)for(n in void 0!==t.key&&(a=""+t.key),t)_.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(s[n]=t[n]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var i=Array(l),o=0;o<l;o++)i[o]=arguments[o+2];s.children=i}if(e&&e.defaultProps)for(n in l=e.defaultProps)void 0===s[n]&&(s[n]=l[n]);return C(e,a,s)},r.createRef=function(){return{current:null}},r.forwardRef=function(e){return{$$typeof:d,render:e}},r.isValidElement=T,r.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:A}},r.memo=function(e,t){return{$$typeof:m,type:e,compare:void 0===t?null:t}},r.startTransition=function(e){var t=k.T,r={};k.T=r;try{var n=e(),s=k.S;null!==s&&s(r,n),"object"==typeof n&&null!==n&&"function"==typeof n.then&&n.then(S,I)}catch(e){I(e)}finally{null!==t&&null!==r.types&&(t.types=r.types),k.T=t}},r.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},r.use=function(e){return k.H.use(e)},r.useActionState=function(e,t,r){return k.H.useActionState(e,t,r)},r.useCallback=function(e,t){return k.H.useCallback(e,t)},r.useContext=function(e){return k.H.useContext(e)},r.useDebugValue=function(){},r.useDeferredValue=function(e,t){return k.H.useDeferredValue(e,t)},r.useEffect=function(e,t){return k.H.useEffect(e,t)},r.useEffectEvent=function(e){return k.H.useEffectEvent(e)},r.useId=function(){return k.H.useId()},r.useImperativeHandle=function(e,t,r){return k.H.useImperativeHandle(e,t,r)},r.useInsertionEffect=function(e,t){return k.H.useInsertionEffect(e,t)},r.useLayoutEffect=function(e,t){return k.H.useLayoutEffect(e,t)},r.useMemo=function(e,t){return k.H.useMemo(e,t)},r.useOptimistic=function(e,t){return k.H.useOptimistic(e,t)},r.useReducer=function(e,t,r){return k.H.useReducer(e,t,r)},r.useRef=function(e){return k.H.useRef(e)},r.useState=function(e){return k.H.useState(e)},r.useSyncExternalStore=function(e,t,r){return k.H.useSyncExternalStore(e,t,r)},r.useTransition=function(){return k.H.useTransition()},r.version="19.2.0"},91788,(e,t,r)=>{"use strict";t.exports=e.r(61556)},31640,(e,t,r)=>{"use strict";r._=function(e){return e&&e.__esModule?e:{default:e}}},71650,(e,t,r)=>{"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}r._=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var s={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=a?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(s,l,i):s[l]=e[l]}return s.default=e,r&&r.set(e,s),s}},89129,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={DecodeError:function(){return p},MiddlewareNotFoundError:function(){return w},MissingStaticPage:function(){return v},NormalizeError:function(){return b},PageNotFoundError:function(){return y},SP:function(){return g},ST:function(){return x},WEB_VITALS:function(){return a},execOnce:function(){return l},getDisplayName:function(){return d},getLocationOrigin:function(){return c},getURL:function(){return u},isAbsoluteUrl:function(){return o},isResSent:function(){return h},loadGetInitialProps:function(){return f},normalizeRepeatedSlashes:function(){return m},stringifyError:function(){return j}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=["CLS","FCP","FID","INP","LCP","TTFB"];function l(e){let t,r=!1;return(...n)=>(r||(r=!0,t=e(...n)),t)}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>i.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function u(){let{href:e}=window.location,t=c();return e.substring(t.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function h(e){return e.finished||e.headersSent}function m(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function f(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await f(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&h(r))return n;if(!n)throw Object.defineProperty(Error(`"${d(e)}.getInitialProps()" should resolve to an object. But found "${n}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let g="undefined"!=typeof performance,x=g&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class p extends Error{}class b extends Error{}class y extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class v extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class w extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function j(e){return JSON.stringify({message:e.message,stack:e.stack})}},13584,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"HeadManagerContext",{enumerable:!0,get:function(){return n}});let n=e.r(31640)._(e.r(91788)).default.createContext({})},94470,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},9465,e=>{"use strict";var t=e.i(91788);let r=t.forwardRef(function({title:e,titleId:r,...n},s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},n),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))});e.s(["ExclamationTriangleIcon",0,r],9465)},57748,e=>{"use strict";var t=e.i(91788);let r=t.forwardRef(function({title:e,titleId:r,...n},s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},n),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))});e.s(["SparklesIcon",0,r],57748)},7432,e=>{"use strict";var t=e.i(91788);let r=t.forwardRef(function({title:e,titleId:r,...n},s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},n),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))});e.s(["ChartBarIcon",0,r],7432)},42248,e=>{"use strict";var t=e.i(91788);let r=t.forwardRef(function({title:e,titleId:r,...n},s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},n),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))});e.s(["MagnifyingGlassIcon",0,r],42248)},7168,e=>{"use strict";class t{handleServiceError(e,t){let r=e instanceof Error?e.message:"服務錯誤";throw console.error(`[${t}] Service Error:`,e),Error(`${t}: ${r}`)}validateServiceInput(e,t){if(null==e)throw Error(`${t} 不能為空`)}async executeWithRetry(e,t=3,r=1e3){for(let n=0;n<t;n++)try{return await e()}catch(e){if(n===t-1)throw e;await new Promise(e=>setTimeout(e,r*(n+1)))}throw Error("操作失敗")}}class r{static instance;services=new Map;static getInstance(){return r.instance||(r.instance=new r),r.instance}getService(e){let t=e.name;return this.services.has(t)||this.services.set(t,new e),this.services.get(t)}clearServices(){this.services.clear()}}e.s(["BaseService",()=>t,"ServiceFactory",()=>r])},97680,e=>{"use strict";var t=e.i(7168);class r extends t.BaseService{static instance;enableLog=!0;static getInstance(){return r.instance||(r.instance=new r),r.instance}constructor(){super()}logInfo(e,t){this.enableLog&&console.log(`[DatabaseService] ${e}`,t||"")}logError(e,t){this.enableLog&&console.error(`[DatabaseService] ${e}`,t||"")}getApiBaseUrl(){return window.location.origin}extractError(e){return e.error||e.message||"操作失敗"}validateConnectionConfig(e){if(!e.server)throw Error("伺服器地址不能為空");if(!e.user||!e.password)throw Error("SQL Server 驗證模式需要提供用戶名和密碼")}async testConnection(e){try{this.logInfo("開始測試數據庫連接",{server:e.server,database:e.database||"預設",user:e.user}),this.validateConnectionConfig(e);let t=this.getApiBaseUrl(),r=await fetch(`${t}/api/database/test-connection`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await r.json();if(n.success)return this.logInfo("數據庫連接測試成功",n.message),n;return this.logError("數據庫連接測試失敗",n.message),n}catch(e){return this.logError("數據庫連接測試發生錯誤",e),{success:!1,message:`連接失敗：${e instanceof Error?e.message:"網路錯誤"}`}}}async executeQuery(e,t,r){try{if(this.logInfo("開始執行 SQL 查詢",{query:t.substring(0,100)+"..."}),!t||!t.trim())return{success:!1,error:"SQL 查詢語句不能為空"};let n=this.getApiBaseUrl(),s=await fetch(`${n}/api/database/execute-query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:e,query:t,params:r})}),a=await s.json();if(a.success)return this.logInfo("SQL 查詢執行成功",{recordCount:a.data?.length||0}),{success:!0,data:a.data||[],count:a.data?.length||0,message:a.message};return this.logError("SQL 查詢執行失敗",this.extractError(a)),{success:!1,error:this.extractError(a)}}catch(e){return this.logError("SQL 查詢執行發生錯誤",e),{success:!1,error:`查詢失敗：${e instanceof Error?e.message:"網路錯誤"}`}}}async getTableList(e){try{this.logInfo("開始獲取數據庫表列表");let t=await this.executeQuery(e,"SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' ORDER BY TABLE_NAME");if(t.success&&t.data){let e=t.data.map(e=>e.TABLE_NAME);return this.logInfo("成功獲取表列表",{tableCount:e.length}),e}{let e=this.extractError(t);if(e.includes("登入失敗"))return this.logError("登入失敗：請檢查使用者名稱、密碼，或確認帳號是否有存取該資料庫的權限。如有疑問請聯絡資料庫管理員。",e),[];return this.logError("獲取表列表失敗",e),[]}}catch(e){return this.logError("獲取表列表失敗",e),[]}}async getTableSchema(e,t){try{this.logInfo("開始獲取表結構",{tableName:t});let r=await this.executeQuery(e,"SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE, COLUMN_DEFAULT, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @tableName ORDER BY ORDINAL_POSITION",{tableName:t});if(r.success&&r.data)return this.logInfo("成功獲取表結構",{columnCount:r.data.length}),r.data;throw Error(this.extractError(r))}catch(e){throw this.logError("獲取表結構失敗",e),Error(e instanceof Error?e.message:"獲取表結構失敗")}}async getDatabaseList(e){try{this.logInfo("開始獲取資料庫列表");let t={...e,database:"master"},r=await this.executeQuery(t,"SELECT name FROM sys.databases WHERE database_id > 4 ORDER BY name");if(r.success&&r.data){let e=r.data.map(e=>e.name);return this.logInfo("成功獲取資料庫列表",{databaseCount:e.length}),e}throw Error(this.extractError(r))}catch(e){throw this.logError("獲取資料庫列表失敗",e),Error(e instanceof Error?e.message:"獲取資料庫列表失敗")}}}e.s(["DatabaseService",()=>r])},80962,e=>{"use strict";var t=e.i(91788);let r=t.forwardRef(function({title:e,titleId:r,...n},s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},n),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z"}))});e.s(["ServerIcon",0,r],80962)},15125,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={VALID_LOADERS:function(){return a},imageConfigDefault:function(){return l}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let a=["default","imgix","cloudinary","akamai","custom"],l={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},13521,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ImageConfigContext",{enumerable:!0,get:function(){return a}});let n=e.r(31640)._(e.r(91788)),s=e.r(15125),a=n.default.createContext(s.imageConfigDefault)},91412,8081,e=>{"use strict";var t=e.i(91788);let r=t.forwardRef(function({title:e,titleId:r,...n},s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},n),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))});e.s(["EyeIcon",0,r],91412);let n=t.forwardRef(function({title:e,titleId:r,...n},s){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},n),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))});e.s(["EyeSlashIcon",0,n],8081)},81250,e=>{"use strict";var t=e.i(91398),r=e.i(91788);let n=r.forwardRef(function({title:e,titleId:t,...n},s){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))});var s=e.i(42248),a=e.i(57748),l=e.i(80962);let i=r.forwardRef(function({title:e,titleId:t,...n},s){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))});var o=e.i(9465),c=e.i(78823);let u=r.forwardRef(function({title:e,titleId:t,...n},s){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))});var d=e.i(83721),h=e.i(99753),m=e.i(58460),f=e.i(71344),g=e.i(7432),x=e.i(91412),p=e.i(8081);let b=({data:e,title:n="趨勢圖",height:s=500,theme:a="light",showBothLines:l=!1})=>{let i=(0,r.useRef)(null),o=(0,r.useRef)(null),c=(0,r.useRef)(null),u=(0,r.useRef)(null),[d,b]=(0,r.useState)(!1),[y,v]=(0,r.useState)(null),[w,j]=(0,r.useState)(null),[N,E]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(console.log("Chart initialization - data:",e?.length),!i.current)return void console.error("Chart container is null");if(!e?.length)return void console.error("No data provided");let t="dark"===a;try{o.current&&(console.log("Removing old chart"),o.current.remove(),o.current=null),console.log("Creating chart with container width:",i.current.clientWidth);let r=(0,h.createChart)(i.current,{layout:{background:{type:h.ColorType.Solid,color:t?"#1f2937":"#ffffff"},textColor:t?"#e5e7eb":"#374151"},width:i.current.clientWidth||800,height:d?window.innerHeight-200:s,grid:{vertLines:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},horzLines:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},crosshair:{mode:1},rightPriceScale:{borderColor:t?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)"},timeScale:{borderColor:t?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",timeVisible:!0,secondsVisible:!1},localization:{locale:"zh-TW"}});o.current=r,console.log("Chart created successfully");let n=[],a=[];if(e.forEach((e,t)=>{let r=e.date.includes("T")?Math.floor(new Date(e.date).getTime()/1e3):e.date.split("T")[0];console.log(`Processing data point ${t}:`,{date:e.date,timeValue:r,value:e.value,predictValue:e.predictValue}),null==e.value||isNaN(Number(e.value))||n.push({time:r,value:Number(e.value)}),l&&null!=e.predictValue&&!isNaN(Number(e.predictValue))&&a.push({time:r,value:Number(e.predictValue)})}),console.log("Processed data:",{lineData:n.length,predictData:a.length}),N&&n.length>0){let e=r.addSeries(h.LineSeries,{color:"#3b82f6",lineWidth:3,priceLineVisible:!1,lastValueVisible:!1,crosshairMarkerVisible:!0,crosshairMarkerRadius:6});console.log("Setting main line data:",n.length,"points"),e.setData(n),c.current=e}if(l&&a.length>0){let e=r.addSeries(h.LineSeries,{color:"#10b981",lineWidth:2,priceLineVisible:!1,lastValueVisible:!1,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,lineStyle:2});console.log("Setting predict line data:",a.length,"points"),e.setData(a),u.current=e}r.subscribeCrosshairMove(t=>{if(t&&t.time&&t.point){let r=t.time.toString(),n=e.find(e=>(e.date.includes("T")?Math.floor(new Date(e.date).getTime()/1e3).toString():e.date.split("T")[0])===r);n?(v(n),j({x:t.point.x,y:t.point.y})):(v(null),j(null))}else v(null),j(null)}),r.timeScale().fitContent(),console.log("Chart initialization completed successfully")}catch(e){console.error("Chart initialization error:",e)}return()=>{o.current&&(o.current.remove(),o.current=null),c.current=null,u.current=null}},[e,a,s,d,N,l]),(0,r.useEffect)(()=>{let e=()=>{o.current&&i.current&&o.current.applyOptions({width:i.current.clientWidth,height:d?window.innerHeight-180:s})};if(d)return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[d,s]),(0,r.useEffect)(()=>{d&&window.scrollTo({top:0,behavior:"smooth"})},[d]);let S=e=>{let t=new Date(e);if(isNaN(t.getTime()))return e;let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0");return"00"===a&&"00"===l?`${r}/${n}/${s}`:`${r}/${n}/${s} ${a}:${l}`};return(console.log("Render - data length:",e?.length,"chart ref exists:",!!o.current),e?.length)?(0,t.jsxs)("div",{className:`relative bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden ${d?"fixed inset-0 z-[9999] m-0 rounded-none shadow-lg":""}`,children:[(0,t.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,t.jsx)(g.ChartBarIcon,{className:"h-5 w-5 text-gray-600"})}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:n}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:[e.length," 個預測點 • ",(()=>{if(!e?.length)return"--";let t=S(e[0].date),r=S(e[e.length-1].date);return`${t} ~ ${r}`})()]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"flex items-center space-x-2 bg-white border border-gray-200 rounded-lg px-3 py-2",children:(0,t.jsxs)("button",{onClick:()=>E(!N),className:`flex items-center space-x-1 px-2 py-1 rounded text-xs transition-colors ${N?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"}`,children:[N?(0,t.jsx)(x.EyeIcon,{className:"h-3 w-3"}):(0,t.jsx)(p.EyeSlashIcon,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"預測值"})]})}),(0,t.jsx)("button",{onClick:()=>b(!d),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",title:d?"退出全屏":"進入全屏",children:d?(0,t.jsx)(f.ArrowsPointingInIcon,{className:"h-4 w-4"}):(0,t.jsx)(m.ArrowsPointingOutIcon,{className:"h-4 w-4"})})]})]})}),(0,t.jsxs)("div",{className:"p-4 relative",children:[y&&w&&(0,t.jsxs)("div",{className:"absolute z-10 bg-white/95 border border-gray-200 rounded-lg shadow-lg px-4 py-3 text-sm text-gray-800 pointer-events-none",style:{left:`calc(${w.x}px + 20px)`,top:`calc(${w.y}px - 10px)`,minWidth:"180px"},children:[(0,t.jsx)("div",{className:"font-medium text-gray-900 mb-2",children:S(y.date)}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-600",children:l?"真實值:":"預測值:"}),(0,t.jsx)("span",{className:"font-medium text-blue-600",children:y.value.toFixed(4)})]}),l&&void 0!==y.predictValue&&(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"預測值:"}),(0,t.jsx)("span",{className:"font-medium text-green-600",children:y.predictValue.toFixed(4)})]})]})]}),(0,t.jsx)("div",{ref:i,style:{height:d?"calc(100vh - 150px)":`${s}px`,width:"100%",minHeight:"400px"},className:"bg-white rounded border border-gray-100"})]}),(0,t.jsx)("div",{className:"bg-gray-50 px-6 py-2 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["預測點數: ",e.length]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[N&&(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"w-3 h-0.5 bg-blue-600 mr-1"}),l?"真實值":"預測值"]}),l&&(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"w-3 h-0.5 bg-green-600 mr-1"}),"預測值"]})]}),(0,t.jsx)("div",{className:"text-center text-[12px] select-none",children:"Powered by TradingView Lightweight Charts"})]})})]}):(0,t.jsx)("div",{className:"flex items-center justify-center bg-white rounded-lg border border-gray-200 shadow-sm",style:{height:`${s}px`},children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(g.ChartBarIcon,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"暫無圖表數據"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"請提供有效的預測數據"})]})})};var y=e.i(97680);e.s(["default",0,()=>{let[e,h]=(0,r.useState)(null),[m,f]=(0,r.useState)(null),[g,x]=(0,r.useState)(!1),[p,v]=(0,r.useState)(""),[w,j]=(0,r.useState)("US"),[N,E]=(0,r.useState)("AAPL"),[S,k]=(0,r.useState)(192),[_,C]=(0,r.useState)(12),T=[{value:"US",label:"美國",flag:"🇺🇸",db:"market_stock_us"},{value:"TW",label:"台灣",flag:"🇹🇼",db:"market_stock_tw"},{value:"CRYPTO",label:"加密貨幣",flag:"₿",db:"market_crypto"}],[L,O]=(0,r.useState)({server:"",user:"",password:"",database:"",port:void 0,options:{}}),[M,A]=(0,r.useState)(!1),[I,R]=(0,r.useState)(!1),[P,$]=(0,r.useState)([]),H=(0,r.useMemo)(()=>y.DatabaseService.getInstance(),[]),D=(0,r.useCallback)(async()=>{R(!0),v("");try{let e=window.location.origin,t=await fetch(`${e}/api/database/test-connection`,{method:"GET"}),r=await t.json();r.success?(A(!0),v(""),console.log("資料庫連接成功:",r.message)):(A(!1),v(r.message))}catch(e){A(!1),v(e instanceof Error?e.message:"連接失敗")}finally{R(!1)}},[L]),B=(0,r.useCallback)(async()=>{if(!M)return void v("請先連接資料庫");if(!N.trim())return void v("請輸入股票代碼");R(!0),v("");try{let e=`
        SELECT TOP 10000
          close_price
        FROM stock_data_1h
        WHERE symbol = @symbol
        ORDER BY datetime DESC
      `,t=await H.executeQuery(L,e,{symbol:N.toUpperCase()});if(t.success&&t.data){let e=t.data.map(e=>e.close_price);$(e)}else v(t.error||`找不到 ${N} 的資料`)}catch(e){v(e instanceof Error?e.message:"查詢失敗")}finally{R(!1)}},[M,N,L,H]),V=(0,r.useCallback)(e=>{E(e)},[]),U=(0,r.useCallback)(async e=>{x(!0),v(""),h(null),f(null);try{let t=await fetch("/api/py/stock_prediction/predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok||r.detail)throw Error(r.detail||`HTTP error! status: ${t.status}`);h(r)}catch(e){v(e instanceof Error?e.message:"預測失敗")}finally{x(!1)}},[]),W=(0,r.useCallback)(async e=>{x(!0),v(""),f(null),h(null);try{let t=await fetch("/api/py/stock_prediction/long_term_eval",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok||r.detail)throw Error(r.detail||`HTTP error! status: ${t.status}`);f(r)}catch(e){v(e instanceof Error?e.message:"評估失敗")}finally{x(!1)}},[]),F=(0,r.useCallback)(()=>{U({data_numpy:P,context_length:S,prediction_length:_})},[P,S,_,U]),z=(0,r.useCallback)(()=>{W({data_numpy:P,context_length:S,prediction_length:_})},[P,S,_,W]),Z=(0,r.useCallback)(e=>{let t=new Date,r=[],n=e.mean;if(!Array.isArray(n)||0===n.length)return[];for(let e=0;e<n.length;e++){let s=new Date(t);s.setHours(s.getHours()+(e+1));let a=n[e];r.push({date:s.toISOString(),value:Number(a)||0})}return r},[]),Y=(0,r.useCallback)(e=>{let t=[];if(!e.true_value?.length||!e.predict?.length)return[];let r=Array.isArray(e.true_value)?[...e.true_value]:[],n=Array.isArray(e.predict)?[...e.predict]:[],s=Math.max(r.length,n.length),a=new Date;a.setHours(a.getHours()-s);for(let e=0;e<s;e++){let s=new Date(a);s.setHours(s.getHours()+(e+1));let l=e<r.length?r[e]:0,i=e<n.length?n[e]:0;t.push({date:s.toISOString(),value:Number(l)||0,predictValue:Number(i)||0})}return t},[]),Q=(0,r.useMemo)(()=>e?Z(e):[],[e,Z]),G=(0,r.useMemo)(()=>m?Y(m):[],[m,Y]);return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsxs)("section",{className:"relative bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center overflow-hidden shadow-2xl",children:[(0,t.jsx)("div",{className:"absolute inset-0 opacity-20",children:(0,t.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:`
                linear-gradient(rgba(255,255,255,0.06) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.06) 1px, transparent 1px)
              `,backgroundSize:"60px 60px"}})}),(0,t.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full",children:[(0,t.jsx)("div",{className:"absolute top-12 left-12 w-24 h-24 bg-white opacity-5 rounded-full animate-pulse"}),(0,t.jsx)("div",{className:"absolute bottom-12 right-24 w-36 h-36 bg-white opacity-5 rounded-full animate-pulse",style:{animationDelay:"1s"}}),(0,t.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-radial from-white/10 to-transparent rounded-full"}),(0,t.jsx)("div",{className:"absolute top-24 right-12 w-4 h-4 bg-white opacity-20 rounded-full animate-bounce"}),(0,t.jsx)("div",{className:"absolute bottom-24 left-24 w-3 h-3 bg-white opacity-30 rounded-full animate-pulse",style:{animationDelay:"1.5s"}})]}),(0,t.jsx)("div",{className:"relative max-w-7xl mx-auto px-6 sm:px-8 lg:px-12 py-16 z-10 w-full",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-8",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center mb-6",children:[(0,t.jsx)("div",{className:"p-4 bg-white/10 rounded-3xl backdrop-blur-sm mr-6 group hover:bg-white/20 transition-all duration-300 shadow-lg",children:(0,t.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,t.jsx)(a.SparklesIcon,{className:"h-8 w-8 text-white"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-4xl lg:text-5xl font-bold text-white tracking-tight leading-tight",children:"股票預測分析"}),(0,t.jsx)("p",{className:"text-blue-100 mt-3 text-lg font-medium",children:"基於機器學習的股票價格預測模型"})]})]}),(0,t.jsx)("p",{className:"text-blue-100 text-lg max-w-3xl leading-relaxed",children:"使用真實歷史價格資料與 AI 模型，產生短期/中期價格走勢預測，並提供模型評估視覺化結果。"})]}),(0,t.jsx)("div",{className:"flex flex-col lg:items-end space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6 lg:gap-8",children:[(0,t.jsxs)("div",{className:"text-center bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20 shadow-lg",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-white",children:"即時"}),(0,t.jsx)("div",{className:"text-blue-200 text-sm font-medium",children:"模型回饋"})]}),(0,t.jsxs)("div",{className:"text-center bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20 shadow-lg",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-white",children:"可視化"}),(0,t.jsx)("div",{className:"text-blue-200 text-sm font-medium",children:"趨勢圖表"})]})]})})]})})]}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)(s.MagnifyingGlassIcon,{className:"w-6 h-6 text-blue-600"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"股票選擇"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"選擇市場"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-4",children:T.map(e=>(0,t.jsxs)("button",{onClick:()=>{j(e.value),O({...L,database:e.db})},className:`flex items-center justify-center p-4 rounded-lg border-2 transition-all ${w===e.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:[(0,t.jsx)("span",{className:"text-2xl mr-3",children:e.flag}),(0,t.jsx)("span",{className:"font-medium",children:e.label})]},e.value))})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["股票代碼","TW"===w&&(0,t.jsx)("span",{className:"text-gray-500 ml-1",children:"(例: 2330)"}),"US"===w&&(0,t.jsx)("span",{className:"text-gray-500 ml-1",children:"(例: AAPL)"}),"CRYPTO"===w&&(0,t.jsx)("span",{className:"text-gray-500 ml-1",children:"(例: BTC)"})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("input",{type:"text",value:N,onChange:e=>E(e.target.value.toUpperCase()),className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`輸入${T.find(e=>e.value===w)?.label}股票代碼`,onKeyDown:e=>"Enter"===e.key&&B()}),(0,t.jsxs)("button",{onClick:B,disabled:!M||I||!N.trim(),className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg transition-colors flex items-center space-x-2",children:[(0,t.jsx)(s.MagnifyingGlassIcon,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:I?"查詢中...":"查詢"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["熱門",T.find(e=>e.value===w)?.label,"股票"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:({US:["AAPL","GOOGL","MSFT","AMZN","TSLA","META","NVDA","AMD"],TW:["2330","2317","2454","2881","6505","3008","2382","2303"],CRYPTO:["BTC-USD","SOL-USD","ETH-USD"]})[w]?.map(e=>(0,t.jsx)("button",{onClick:()=>V(e),className:`px-3 py-2 text-sm rounded-md transition-colors ${N===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)(n,{className:"w-6 h-6 text-blue-600"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"預測參數"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Context Length"}),(0,t.jsx)("input",{type:"number",value:S,onChange:e=>k(parseInt(e.target.value)||192),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"192"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prediction Length"}),(0,t.jsx)("input",{type:"number",value:_,onChange:e=>C(parseInt(e.target.value)||12),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"12"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(n,{className:"w-6 h-6 text-blue-600"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"資料庫連接"}),(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${M?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:M?"已連接":"未連接"})]})}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:D,disabled:I,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors",children:I?"連接中...":"測試連接"}),(0,t.jsx)("button",{onClick:B,disabled:!M||I,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors",children:I?"查詢中...":"查詢股票資料"})]}),N&&(0,t.jsx)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["已選擇:"," ",(0,t.jsxs)("span",{className:"font-medium",children:[T.find(e=>e.value===w)?.flag," ",N]}),P.length>0&&(0,t.jsxs)("span",{className:"ml-3",children:["• 已載入 ",P.length," 筆資料，最新價格:"," ",P[0]?.toFixed(2)]})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,t.jsxs)("div",{className:"mb-8 text-center",children:[(0,t.jsx)("div",{className:"w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(a.SparklesIcon,{className:"w-12 h-12 text-gray-400"})}),(0,t.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"股票預測模型"}),(0,t.jsx)("p",{className:"text-gray-600 leading-relaxed mb-6",children:P.length>0?`使用 ${N} 的真實資料進行預測，查看未來的價格預測。`:"請先選擇股票並查詢資料，然後進行預測分析。"}),(0,t.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,t.jsx)("button",{onClick:F,disabled:g||P.length<S,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-8 py-3 rounded-lg transition-colors text-lg font-medium",children:g?"預測中...":`預測 ${N||"股票"} 價格`}),(0,t.jsx)("button",{onClick:z,disabled:g||P.length<S+_,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-8 py-3 rounded-lg transition-colors text-lg font-medium",children:g?"評估中...":`評估模型準確度`})]}),p&&(0,t.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,t.jsx)("p",{className:"text-red-700 font-medium",children:"錯誤："}),(0,t.jsx)("p",{className:"text-red-600 text-sm mt-1",children:p}),p.includes("shapes")&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-2",children:"這是後端模型維度問題，請檢查 Python 代碼中的矩陣計算邏輯"})]})]}),(e||m)&&(0,t.jsxs)("div",{className:"mt-8",children:[e&&!m&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4 text-center",children:"AI 預測結果"}),(0,t.jsx)(b,{data:Q,title:"股票價格預測趨勢",height:600})]}),m&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4 text-center",children:"模型評估結果"}),(0,t.jsx)(b,{data:G,title:"預測準確度評估 - 真實值 vs 預測值",height:600,showBothLines:!0})]})]})]})]}),(0,t.jsx)("div",{className:"bg-gray-50 pb-8",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:(0,t.jsx)(l.ServerIcon,{className:"h-5 w-5 text-blue-600"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"系統資訊"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center text-sm",children:[(0,t.jsx)(i,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,t.jsx)("span",{className:"text-gray-600",children:"預測模型："}),(0,t.jsx)("span",{className:"ml-1 font-medium text-gray-900",children:"Chronos Forecasting"})]}),(0,t.jsx)("span",{className:"block mt-2 text-xs text-gray-500",children:"使用 LSTM、Transformer 等深度學習架構進行時間序列預測"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"p-2 bg-green-100 rounded-lg mr-3",children:(0,t.jsx)(u,{className:"h-5 w-5 text-green-600"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"數據來源"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center text-sm",children:[(0,t.jsx)(c.DocumentTextIcon,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,t.jsx)("span",{className:"text-gray-700",children:"歷史真實市場數據"})]}),(0,t.jsx)("span",{className:"block mt-2 text-xs text-gray-500",children:"資料來自 Yahoo Finance，包含股票與加密貨幣的歷史價格"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg mr-3",children:(0,t.jsx)(o.ExclamationTriangleIcon,{className:"h-5 w-5 text-yellow-600"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"免責聲明"})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 leading-relaxed",children:["本系統提供的分析僅供參考，投資決策請自行評估風險。",(0,t.jsx)("span",{className:"block mt-2 text-xs text-gray-500",children:"AI預測結果基於歷史數據分析，不保證未來表現。"})]})]})]})})})}),(0,t.jsx)(d.default,{})]})}],81250)},81687,(e,t,r)=>{let n="/predict";(window.__NEXT_P=window.__NEXT_P||[]).push([n,()=>e.r(81250)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([n])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/bc605f86bb4166d2.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/700022329b1c82af.js"].map(t=>e.l(t))).then(()=>t(79466)))}]);