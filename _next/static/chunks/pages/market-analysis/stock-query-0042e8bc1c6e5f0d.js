(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[35],{1539:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(7876);a(4232);var l=a(7021),s=a(9038);let n=()=>(0,r.jsxs)("footer",{className:"bg-gray-900 text-gray-300 relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-5",children:(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-blue-500/20 to-purple-500/20"})}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 relative z-10 pt-12",children:[(0,r.jsxs)("div",{className:"grid lg:grid-cols-4 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mr-4",children:(0,r.jsx)(l.A,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-white",children:"FinTech Studio"}),(0,r.jsx)("p",{className:"text-gray-400",children:"智慧金融分析平台"})]})]}),(0,r.jsx)("p",{className:"text-gray-400 leading-relaxed mb-6 max-w-md",children:"金融走勢智慧分析，讓投資更簡單。透過 AI 技術，提供即時市場分析、訊號分析和交易建議，助您做出明智的投資決策。"}),(0,r.jsx)("div",{className:"flex space-x-4",children:(0,r.jsx)("a",{href:"https://github.com/fintech-studio/financial-analysis",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center transition-colors group",children:(0,r.jsx)(s.hL4,{className:"w-5 h-5 text-gray-400 group-hover:text-white transition-colors"})})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-white font-semibold mb-6",children:"功能"}),(0,r.jsx)("ul",{className:"space-y-3",children:["市場分析","財經新聞","AI 預測","AI 助理"].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:["/market-analysis","/news","/predict","/chat"][["市場分析","財經新聞","AI 預測","AI 助理"].indexOf(e)],className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-white font-semibold mb-6",children:"支援"}),(0,r.jsx)("ul",{className:"space-y-3",children:["幫助中心","聯絡我們","隱私政策","服務條款"].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-800 mt-8 pt-8 flex flex-col md:flex-row items-center justify-center",children:(0,r.jsxs)("p",{className:"text-gray-400 text-sm text-center",children:["\xa9 ",new Date().getFullYear()," FinTech Studio. All rights reserved."]})})]})]})},8923:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>et});var r=a(7876),l=a(4232),s=a(4395),n=a(5784),i=a(7043),o=a(8974),c=a(4254),d=a(7021);let m=[{value:"market_stock_tw",label:"台股",color:"bg-blue-100 text-blue-700 border-blue-200"},{value:"market_stock_us",label:"美股",color:"bg-red-100 text-red-700 border-red-200"},{value:"market_etf",label:"ETF",color:"bg-green-100 text-green-700 border-green-200"},{value:"market_index",label:"指數",color:"bg-orange-100 text-orange-700 border-orange-200"},{value:"market_forex",label:"外匯",color:"bg-purple-100 text-purple-700 border-purple-200"},{value:"market_crypto",label:"加密貨幣",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},{value:"market_futures",label:"期貨",color:"bg-pink-100 text-pink-700 border-pink-200"}],g=[{symbol:"2330",name:"台積電",type:"上市",market:"market_stock_tw"},{symbol:"9950",name:"萬國通",type:"上櫃",market:"market_stock_tw"},{symbol:"AAPL",name:"Apple",type:"US",market:"market_stock_us"},{symbol:"TSLA",name:"Tesla",type:"US",market:"market_stock_us"},{symbol:"000001.SS",name:"上證綜合指數",type:"CN",market:"market_index"},{symbol:"^DJI",name:"道瓊工業指數",type:"US",market:"market_index"},{symbol:"^GSPC",name:"標普500指數",type:"US",market:"market_index"},{symbol:"^N225",name:"日經225指數",type:"JP",market:"market_index"},{symbol:"^TWII",name:"台灣加權指數",type:"TW",market:"market_index"},{symbol:"^TWOII",name:"台灣櫃買指數",type:"TWO",market:"market_index"},{symbol:"0050",name:"元大台灣50",type:"ETF",market:"market_etf"},{symbol:"00878",name:"國泰永續高股息",type:"ETF",market:"market_etf"},{symbol:"TWD=X",name:"美元/台幣",type:"外匯",market:"market_forex"},{symbol:"JPYTWD=X",name:"日圓/台幣",type:"外匯",market:"market_forex"},{symbol:"CL=F",name:"原油",type:"期貨",market:"market_futures"},{symbol:"GC=F",name:"黃金",type:"期貨",market:"market_futures"},{symbol:"BTC-USD",name:"比特幣",type:"Crypto",market:"market_crypto"},{symbol:"ETH-USD",name:"以太坊",type:"Crypto",market:"market_crypto"},{symbol:"SOL-USD",name:"索拉納",type:"Crypto",market:"market_crypto"}],x={market_stock_tw:"market_stock_tw",market_stock_us:"market_stock_us",market_etf:"market_etf",market_index:"market_index",market_forex:"market_forex",market_crypto:"market_crypto",market_futures:"market_futures",台股:"market_stock_tw",美股:"market_stock_us",ETF:"market_etf",指數:"market_index",外匯:"market_forex",加密貨幣:"market_crypto",期貨:"market_futures"},u=e=>{let{symbol:t,onSymbolChange:a,timeframe:u,onTimeframeChange:h,loading:y=!1,market:b,onMarketChange:p,onSymbolAndMarketChange:f}=e,[,v]=(0,l.useState)(!1),[w,j]=(0,l.useState)(!1),[N,k]=(0,l.useState)(-1),[C,_]=(0,l.useState)(t),{suggestions:S,fetching:A}=function(e){let[t,a]=(0,l.useState)([]),[r,s]=(0,l.useState)(!1),n=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(!e.trim())return void a([]);s(!0),n.current&&n.current.abort();let t=new AbortController;return n.current=t,fetch("/api/market_data?q=".concat(encodeURIComponent(e)),{signal:t.signal}).then(e=>e.json()).then(e=>{a(Array.isArray(e)?e.slice(0,50):[])}).catch(e=>{"AbortError"!==e.name&&a([])}).finally(()=>s(!1)),()=>t.abort()},[e]),{suggestions:t,fetching:r}}(function(e,t){let[a,r]=(0,l.useState)(e);return(0,l.useEffect)(()=>{let t=setTimeout(()=>r(e),300);return()=>clearTimeout(t)},[e,300]),a}(C,300)),D=(0,l.useMemo)(()=>m,[]),M=(0,l.useMemo)(()=>g,[]);(0,l.useEffect)(()=>{_(t)},[t]);let T=(0,l.useCallback)(async()=>{if(C.trim())try{let e=await fetch("/api/market_data?q=".concat(encodeURIComponent(C))),t=await e.json();if(Array.isArray(t)&&t.length>0){let e=x[t[0].market_category];e&&e!==b&&p(e)}}catch(e){}finally{a(C)}},[C,b,p,a]),E=(0,l.useCallback)((e,t)=>{if(_(e),t){let e=x[t];e&&e!==b&&p(e)}a(e),j(!1),k(-1)},[b,p,a]),L=(0,l.useCallback)(e=>{let t=e.target.value.toUpperCase();_(t),j(!!t.trim()),k(-1)},[]),R=(0,l.useCallback)(e=>{if(!w||0===S.length){"Enter"===e.key&&(e.preventDefault(),!y&&C.trim()&&T());return}if("ArrowDown"===e.key)e.preventDefault(),k(e=>e<S.length-1?e+1:0);else if("ArrowUp"===e.key)e.preventDefault(),k(e=>e>0?e-1:S.length-1);else if("Enter"===e.key)if(e.preventDefault(),N>=0){let e=S[N];E(e.symbol,e.market_type)}else!y&&C.trim()&&(a(C),j(!1));else"Escape"===e.key&&(j(!1),k(-1))},[w,S,N,y,C,T,E,a]),K=(0,l.useCallback)(e=>{let t=e.market_type||e.market_category,r=t&&x[t];f&&r?f(e.symbol,r):(r&&r!==b&&p(r),a(e.symbol)),_(e.symbol),j(!1),k(-1)},[b,p,a,f]),I=(0,l.useCallback)(()=>{v(!0),C.trim()&&S.length>0&&j(!0)},[C,S]),U=(0,l.useCallback)(()=>{v(!1),setTimeout(()=>j(!1),150)},[]),F=(0,l.useCallback)(e=>{_(e)},[]),W=(0,l.useCallback)(e=>{var t;return(0,r.jsxs)("span",{className:"ml-2 px-2 py-1 text-xs bg-blue-50 text-blue-700 border border-blue-200 rounded",children:[e.market_category,e.market_type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"mx-1 text-gray-400",children:"-"}),(0,r.jsx)("span",{className:"text-xs text-blue-700",children:(null==(t=D.find(t=>t.value===e.market_type))?void 0:t.label)||e.market_type})]})]})},[D]);return(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mt-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-6 xl:flex-row xl:gap-4 xl:items-end",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-[220px]",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(i.A,{className:"w-4 h-4 inline mr-1"}),"金融代號"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:C,onChange:L,onKeyDown:R,onFocus:I,onBlur:U,placeholder:"輸入金融代號 (例: 2330, AAPL, 0050, CL=F)",className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-1 focus:ring-gray-900 focus:outline-none",disabled:y,"aria-autocomplete":"list","aria-controls":"stock-suggestions","aria-activedescendant":N>=0?"suggestion-".concat(N):void 0}),(y||A)&&(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,r.jsx)(o.A,{className:"w-5 h-5 text-gray-500 animate-spin"})}),(0,r.jsx)(n.N,{children:w&&S.length>0&&(0,r.jsx)(s.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-20 left-0 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-y-auto",id:"stock-suggestions",role:"listbox",children:S.map((e,t)=>(0,r.jsxs)("button",{id:"suggestion-".concat(t),onClick:()=>K(e),className:"w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 transition-colors border-b border-gray-100 last:border-b-0 ".concat(t===N?"bg-gray-50":""),role:"option","aria-selected":t===N,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 font-medium text-gray-900",children:[(0,r.jsx)("span",{children:e.symbol}),W(e)]}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.name})]},e.symbol+(e.market_type||"")))})})]})]}),(0,r.jsx)("div",{className:"max-w-[320px] flex flex-col items-start",children:(0,r.jsxs)("div",{className:"flex flex-wrap w-full",children:[(0,r.jsx)("div",{className:"flex w-full gap-2 mb-2",children:D.slice(0,4).map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>p(e.value),className:"flex-1 flex items-center gap-1 px-3 py-1 rounded-md font-medium text-sm border transition-all duration-150\n                    ".concat(b===e.value?"".concat(e.color," shadow"):"bg-white text-gray-600 border-gray-300 hover:bg-gray-50","\n                  "),disabled:y,"aria-pressed":b===e.value,children:e.label},e.value))}),(0,r.jsx)("div",{className:"flex w-full gap-2",children:D.slice(4).map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>p(e.value),className:"flex-1 flex items-center gap-1 px-3 py-1 rounded-md font-medium text-sm border transition-all duration-150\n                    ".concat(b===e.value?"".concat(e.color," shadow"):"bg-white text-gray-600 border-gray-300 hover:bg-gray-50","\n                  "),disabled:y,"aria-pressed":b===e.value,children:e.label},e.value))})]})}),(0,r.jsxs)("div",{className:"min-w-[140px] flex flex-col items-start",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(c.A,{className:"w-4 h-4 inline mr-1"}),"時間週期"]}),(0,r.jsx)("div",{className:"flex bg-gray-100 p-1 rounded-md w-full",children:[{value:"1d",label:"日線"},{value:"1h",label:"小時線"}].map(e=>(0,r.jsx)("button",{onClick:()=>h(e.value),className:"flex-1 px-3 py-2 text-sm font-medium rounded transition-all duration-200 ".concat(u===e.value?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),type:"button",children:e.label},e.value))})]}),(0,r.jsx)("div",{className:"w-[120px] flex flex-col items-end justify-end",children:(0,r.jsx)(s.P.button,{whileHover:{scale:y?1:1.02},whileTap:{scale:y?1:.98},onClick:T,disabled:y||!C.trim(),className:"px-4 py-3 bg-gray-900 text-white rounded-md hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium w-full",type:"button",children:y?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)(o.A,{className:"w-4 h-4 mr-2 animate-spin"}),"查詢中"]}):"查詢"})})]}),(0,r.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-3 flex items-center",children:[(0,r.jsx)(d.A,{className:"w-4 h-4 mr-1"}),"熱門股票"]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:M.map(e=>(0,r.jsxs)(s.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onMouseDown:()=>F(e.symbol),onClick:()=>E(e.symbol,e.market),className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md transition-colors flex items-center gap-1",type:"button",children:[(0,r.jsx)("span",{className:"font-medium",children:e.symbol}),(0,r.jsx)("span",{className:"text-gray-500",children:e.name}),(0,r.jsx)("span",{className:"px-1 py-0.5 text-xs bg-gray-200 text-gray-600 rounded",children:e.type})]},e.symbol))})]})]})})};var h=a(3029),y=a(1288);let b=e=>{let{symbol:t,stats:a,timeframe:l}=e,s=e=>e?e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","):"--",n=a.change>=0;return(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-100 p-6 shadow-sm hover:shadow-lg transition-shadow duration-200",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"p-3 bg-gray-50 rounded-xl flex items-center justify-center",children:(0,r.jsx)(h.A,{className:"h-7 w-7 text-gray-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-extrabold text-gray-900 tracking-tight leading-tight mb-1",children:t}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-gray-500",children:[(0,r.jsx)("span",{className:"font-medium",children:"1d"===l?"日線":"小時線"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"|"}),(0,r.jsxs)("span",{children:["最後更新：",(e=>{if(!e)return"--";try{let t=new Date(e);if(isNaN(t.getTime())){let a=e.replace("T"," ").replace("Z","");t=new Date(a)}if(isNaN(t.getTime()))return e;let a=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0");if("1d"===l)return"".concat(a,"/").concat(r,"/").concat(s);{let e=String(t.getUTCHours()).padStart(2,"0"),l=String(t.getUTCMinutes()).padStart(2,"0");return"".concat(a,"/").concat(r,"/").concat(s," ").concat(e,":").concat(l)}}catch(t){return e}})(a.datetime)]})]})]})]}),(0,r.jsxs)("div",{className:"text-right min-w-[120px] flex flex-col items-end justify-center",children:[(0,r.jsx)("div",{className:"text-3xl font-extrabold mb-1 ".concat(n?"text-red-600":"text-green-600"),children:s(a.latest)}),(0,r.jsxs)("div",{className:"flex items-center text-base font-semibold ".concat(n?"text-red-600":"text-green-600"),children:[n?(0,r.jsx)(h.A,{className:"h-4 w-4 mr-1"}):(0,r.jsx)(y.A,{className:"h-4 w-4 mr-1"}),n?"+":"",a.change?a.change.toFixed(2):"0.00"," (",n?"+":"",a.changePercent?a.changePercent.toFixed(2):"0.00","% )"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center p-3 bg-gray-50 rounded-xl",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"開盤 (O)"}),(0,r.jsx)("span",{className:"text-lg font-bold text-gray-900",children:s(a.open_price||a.open)})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center p-3 bg-gray-50 rounded-xl",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"最高 (H)"}),(0,r.jsx)("span",{className:"text-lg font-bold text-gray-900",children:s(a.high)})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center p-3 bg-gray-50 rounded-xl",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"最低 (L)"}),(0,r.jsx)("span",{className:"text-lg font-bold text-gray-900",children:s(a.low)})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center p-3 bg-gray-50 rounded-xl",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"收盤 (C)"}),(0,r.jsx)("span",{className:"text-lg font-bold ".concat(n?"text-red-600":"text-green-600"),children:s(a.latest)})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center p-3 bg-gray-50 rounded-xl",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"成交量 (V)"}),(0,r.jsx)("span",{className:"text-lg font-bold text-gray-900",children:(e=>e?e>=1e9?"".concat((e/1e9).toFixed(1),"B"):e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toLocaleString():"N/A")(a.volume)})]})]})]})};var p=a(1290),f=a(3393),v=a(8787),w=a(2525),j=a(8616);let N=e=>{var t;let{data:a,technicalData:i,title:o="K線圖",height:c=500,showVolume:d=!0,theme:m="light",timeframe:g="1d"}=e,x=(0,l.useRef)(null),u=(0,l.useRef)(null),h=(0,l.useRef)(null),y=(0,l.useRef)(null),b=(0,l.useRef)(new Map),[N,k]=(0,l.useState)(!1),[C,_]=(0,l.useState)(!1),[S,A]=(0,l.useState)("移動平均"),[D,M]=(0,l.useState)(null),[T,E]=(0,l.useState)(null),[L,R]=(0,l.useState)([]),[K,I]=(0,l.useState)([]),[U,F]=(0,l.useState)(!1),W=(0,l.useMemo)(()=>[{key:"ma5",name:"MA5",color:"#3b82f6",enabled:!0,lineWidth:2,category:"移動平均",description:"5日移動平均線",overlay:!0},{key:"ma10",name:"MA10",color:"#f59e0b",enabled:!0,lineWidth:2,category:"移動平均",description:"10日移動平均線",overlay:!0},{key:"ma20",name:"MA20",color:"#ef4444",enabled:!1,lineWidth:2,category:"移動平均",description:"20日移動平均線",overlay:!0},{key:"ma60",name:"MA60",color:"#8b5cf6",enabled:!1,lineWidth:2,category:"移動平均",description:"60日移動平均線",overlay:!0},{key:"ema12",name:"EMA12",color:"#06b6d4",enabled:!1,lineWidth:2,category:"移動平均",description:"12日指數移動平均",overlay:!0},{key:"ema26",name:"EMA26",color:"#84cc16",enabled:!1,lineWidth:2,category:"移動平均",description:"26日指數移動平均",overlay:!0},{key:"bb_upper",name:"布林上軌",color:"#f87171",enabled:!1,lineWidth:1,category:"布林通道",description:"布林帶上軌",overlay:!0},{key:"bb_middle",name:"布林中軌",color:"#fbbf24",enabled:!1,lineWidth:2,category:"布林通道",description:"布林帶中軌",overlay:!0},{key:"bb_lower",name:"布林下軌",color:"#34d399",enabled:!1,lineWidth:1,category:"布林通道",description:"布林帶下軌",overlay:!0},{key:"rsi_5",name:"RSI(5)",color:"#ef4444",enabled:!1,lineWidth:2,category:"震盪指標",description:"5日相對強弱指標",overlay:!1},{key:"rsi_7",name:"RSI(7)",color:"#f59e0b",enabled:!1,lineWidth:2,category:"震盪指標",description:"7日相對強弱指標",overlay:!1},{key:"rsi_14",name:"RSI(14)",color:"#8b5cf6",enabled:!1,lineWidth:2,category:"震盪指標",description:"14日相對強弱指標",overlay:!1},{key:"rsi_21",name:"RSI(21)",color:"#06b6d4",enabled:!1,lineWidth:2,category:"震盪指標",description:"21日相對強弱指標",overlay:!1},{key:"macd",name:"MACD",color:"#3b82f6",enabled:!1,lineWidth:2,category:"趨勢指標",description:"MACD快線",overlay:!1},{key:"dif",name:"DIF",color:"#ef4444",enabled:!1,lineWidth:2,category:"趨勢指標",description:"MACD慢線",overlay:!1},{key:"k_value",name:"K值",color:"#3b82f6",enabled:!1,lineWidth:2,category:"隨機指標",description:"隨機指標K值",overlay:!1},{key:"d_value",name:"D值",color:"#ef4444",enabled:!1,lineWidth:2,category:"隨機指標",description:"隨機指標D值",overlay:!1},{key:"j_value",name:"J值",color:"#f59e0b",enabled:!1,lineWidth:2,category:"隨機指標",description:"隨機指標J值",overlay:!1},{key:"atr",name:"ATR",color:"#84cc16",enabled:!1,lineWidth:2,category:"其他指標",description:"平均真實波幅",overlay:!1},{key:"cci",name:"CCI",color:"#06b6d4",enabled:!1,lineWidth:2,category:"其他指標",description:"順勢指標",overlay:!1},{key:"willr",name:"WillR",color:"#8b5cf6",enabled:!1,lineWidth:2,category:"其他指標",description:"威廉指標",overlay:!1},{key:"mom",name:"MOM",color:"#f87171",enabled:!1,lineWidth:2,category:"其他指標",description:"動量指標",overlay:!1}],[]),[H,V]=(0,l.useState)(W),P=(0,l.useMemo)(()=>{let e={};return H.forEach(t=>{e[t.category]||(e[t.category]=[]),e[t.category].push(t)}),e},[H]),O=(0,l.useMemo)(()=>{if(!(null==a?void 0:a.length))return I(["沒有可用的數據"]),R([]),null;try{let e=((e,t)=>{let a=[],r=[];if(!e||0===e.length)return r.push("沒有可用的數據"),{candleData:[],volumeData:[],warnings:a,errors:r};console.log("\uD83D\uDD0D 開始清理數據: ".concat(e.length," 筆原始數據 (").concat(t,")"));let l=0,s=0,n=0;try{let i=e.map((e,r)=>{try{let i,o;if(!e||!e.date)return a.push("索引 ".concat(r,": 缺少日期資訊")),null;let c=Number(e.open),d=Number(e.high),m=Number(e.low),g=Number(e.close);if([c,d,m,g].some(e=>isNaN(e)||e<=0))return a.push("索引 ".concat(r,": 無效的價格數據 OHLC=[").concat(c,",").concat(d,",").concat(m,",").concat(g,"]")),null;let x=Math.max(c,d,m,g),u=Math.min(c,d,m,g);if((d!==x||m!==u)&&(l++,d!==x&&s++,m!==u&&n++),"1d"===t){let t=e.date.split("T")[0];if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return a.push("索引 ".concat(r,": 無效的日期格式 ").concat(t)),null;i=t,o=new Date(t).getTime()}else{let t=Math.floor(new Date(e.date).getTime()/1e3);if(isNaN(t)||t<=0)return a.push("索引 ".concat(r,": 無效的時間戳 ").concat(e.date)),null;i=t,o=1e3*t}let h=e.volume?Number(e.volume):void 0;void 0!==h&&(isNaN(h)||h<0)&&a.push("索引 ".concat(r,": 無效的成交量 ").concat(e.volume));let y=(c+x+u+g)/4,b=(x-u)/y*100;return b>50&&a.push("索引 ".concat(r,": 極端價格波動 ").concat(b.toFixed(2),"%")),{originalIndex:r,timeValue:i,sortKey:o,open:c,high:x,low:u,close:g,volume:h&&h>0?h:void 0,originalDate:e.date,wasHighCorrected:d!==x,wasLowCorrected:m!==u,originalHigh:d,originalLow:m}}catch(e){return a.push("索引 ".concat(r,": 處理失敗 - ").concat(e)),null}}).filter(e=>null!==e);if(0===i.length)return r.push("所有數據都無效"),{candleData:[],volumeData:[],warnings:a,errors:r};console.log("✅ 基本處理完成: ".concat(i.length,"/").concat(e.length," 筆有效數據")),l>0&&console.log("\uD83D\uDD27 OHLC自動修正統計: 總共 ".concat(l," 筆 (高價修正: ").concat(s,", 低價修正: ").concat(n,")")),i.sort((e,t)=>e.sortKey-t.sortKey);let o=[],c=new Set,d=0;for(let e of i)if(e&&!c.has(e.timeValue))c.add(e.timeValue),o.push(e);else if(e){d++;let r="1d"===t?e.timeValue:new Date(1e3*e.timeValue).toISOString();a.push("移除重複時間戳: ".concat(r))}d>0&&console.log("⚠️  移除 ".concat(d," 個重複時間戳"));for(let e=1;e<o.length;e++){let t=o[e].sortKey,a=o[e-1].sortKey;t<=a&&r.push("時間順序錯誤 at index ".concat(e,": ").concat(t," <= ").concat(a))}if(r.length>0)return{candleData:[],volumeData:[],warnings:a,errors:r};let m=o.map(e=>({time:e.timeValue,open:e.open,high:e.high,low:e.low,close:e.close})),g=o.filter(e=>void 0!==e.volume).map(e=>({time:e.timeValue,value:e.volume,color:e.close>=e.open?"#ef444460":"#10b98160"}));return console.log("\uD83C\uDFAF 數據清理完成:"),console.log("   - K線數據: ".concat(m.length," 筆")),console.log("   - 成交量數據: ".concat(g.length," 筆")),console.log("   - 用戶警告: ".concat(a.length," 個 (OHLC修正已靜默處理)")),{candleData:m,volumeData:g,warnings:a,errors:r}}catch(e){return console.error("❌ 數據清理失敗:",e),r.push("數據處理異常: ".concat(e instanceof Error?e.message:String(e))),{candleData:[],volumeData:[],warnings:a,errors:r}}})(a,g);if(I(e.errors),R(e.warnings),e.errors.length>0)return console.error("❌ 數據驗證失敗:",e.errors),null;return e.warnings.length>0&&console.warn("⚠️  數據警告:",e.warnings),{candleData:e.candleData,volumeData:e.volumeData}}catch(e){return console.error("❌ chartData 處理失敗:",e),I(["數據處理異常: ".concat(e instanceof Error?e.message:String(e))]),R([]),null}},[a,g]),B=(0,l.useMemo)(()=>{if(!i||!(null==a?void 0:a.length)||!O)return{overlay:{},separate:{}};let e={},t={};try{H.filter(e=>e.enabled).forEach(r=>{try{let l=i[r.key];if(!(null==l?void 0:l.length))return void console.warn("⚠️  指標 ".concat(r.key," 沒有數據"));let s=[],n=a.length,o=l.length;for(let e=0;e<n;e++){let t=e-(n-o),r=t>=0?l[t]:null,i=a[e];if(null!=r&&!isNaN(Number(r))&&(null==i?void 0:i.date)){let e="1d"===g?i.date.split("T")[0]:Math.floor(new Date(i.date).getTime()/1e3);s.push({time:e,value:Number(r)})}}s.sort((e,t)=>"1d"===g?e.time.localeCompare(t.time):e.time-t.time);let c=[],d=new Set;for(let e of s)d.has(e.time)||(d.add(e.time),c.push(e));c.length>0?(r.overlay?e[r.key]=c:t[r.key]=c,console.log("✅ 指標 ".concat(r.key," 處理完成: ").concat(c.length," 個數據點"))):console.warn("⚠️  指標 ".concat(r.key," 沒有有效數據點"))}catch(e){console.error("❌ 處理指標 ".concat(r.key," 失敗:"),e)}})}catch(e){console.error("❌ 技術指標數據處理失敗:",e)}return{overlay:e,separate:t}},[i,a,H,g,O]);(0,l.useEffect)(()=>{if(!x.current||!O)return;let e="dark"===m;try{if(u.current)try{u.current.remove()}catch(e){console.warn("清理舊圖表時出現警告:",e)}b.current.clear();let t=(0,p.R9)(x.current,{layout:{background:{type:p.mE.Solid,color:e?"#1f2937":"#ffffff"},textColor:e?"#e5e7eb":"#374151"},width:x.current.clientWidth,height:N?window.innerHeight-200:c,grid:{vertLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},horzLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},crosshair:{mode:1},rightPriceScale:{borderColor:e?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",scaleMargins:{top:.1,bottom:d?.3:.1}},timeScale:{borderColor:e?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",timeVisible:"1h"===g,secondsVisible:!1},localization:{locale:"zh-TW"}});u.current=t;let r=t.addSeries(p.HD,{upColor:"#ef4444",downColor:"#10b981",borderUpColor:"#dc2626",borderDownColor:"#059669",wickUpColor:"#dc2626",wickDownColor:"#059669",priceLineVisible:!0,lastValueVisible:!0});h.current=r;try{r.setData(O.candleData),console.log("✅ K線數據設置成功: ".concat(O.candleData.length," 筆"))}catch(e){throw console.error("❌ K線數據設置失敗:",e),Error("K線數據設置失敗: ".concat(e))}if(d&&O.volumeData.length>0)try{let e=t.addSeries(p.Ej,{color:"#26a69a",priceFormat:{type:"volume"},priceScaleId:"volume"});t.priceScale("volume").applyOptions({scaleMargins:{top:.8,bottom:0},borderVisible:!1}),y.current=e,e.setData(O.volumeData),console.log("✅ 成交量數據設置成功: ".concat(O.volumeData.length," 筆"))}catch(e){console.error("❌ 成交量設置失敗:",e)}let l=Object.keys(B.overlay);if(l.length>0){let e=new Map;l.forEach(a=>{try{let l=B.overlay[a],s=H.find(e=>e.key===a);if(s&&l&&l.length>0){var r;let n=t.addSeries(p.Im,{color:s.color,lineWidth:null!=(r=s.lineWidth)?r:2,title:s.name,priceLineVisible:!1,lastValueVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4});n.setData(l),e.set(a,n),console.log("✅ 疊加指標 ".concat(s.name," 設置成功"))}}catch(e){console.error("❌ 疊加指標 ".concat(a," 設置失敗:"),e)}}),b.current=e}let s=Object.keys(B.separate);s.length>0&&s.forEach(e=>{try{let r=B.separate[e],l=H.find(t=>t.key===e);if(l&&r&&r.length>0){var a;let s="indicator_".concat(e),n=t.addSeries(p.Im,{color:l.color,lineWidth:null!=(a=l.lineWidth)?a:2,title:l.name,priceLineVisible:!1,lastValueVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,priceScaleId:s});t.priceScale(s).applyOptions({scaleMargins:{top:.7,bottom:.1},borderVisible:!1}),n.setData(r),b.current||(b.current=new Map),b.current.set(e,n),console.log("✅ 獨立指標 ".concat(l.name," 設置成功"))}}catch(t){console.error("❌ 獨立指標 ".concat(e," 設置失敗:"),t)}}),t.subscribeCrosshairMove(e=>{try{if(e&&e.time&&e.point)if(O.candleData.find(t=>t.time===e.time)){let t=a[O.candleData.findIndex(t=>t.time===e.time)];M(t||null),E({x:e.point.x,y:e.point.y})}else M(null),E(null);else M(null),E(null)}catch(e){console.error("滑鼠事件處理錯誤:",e)}}),console.log("\uD83C\uDFAF 圖表初始化成功")}catch(e){console.error("❌ 圖表初始化失敗:",e),I(["圖表初始化失敗: ".concat(e instanceof Error?e.message:String(e))])}return()=>{try{u.current&&(u.current.remove(),u.current=null),h.current=null,y.current=null,b.current.clear()}catch(e){console.warn("圖表清理時出現警告:",e)}}},[O,B,d,m,c,N,g,H,a]),(0,l.useEffect)(()=>{let e=()=>{if(u.current&&x.current)try{u.current.applyOptions({width:x.current.clientWidth,height:N?window.innerHeight-180:c})}catch(e){console.error("圖表大小調整失敗:",e)}};if(N)return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[N,c]);let z=(0,l.useCallback)(e=>{V(t=>t.map(t=>t.key===e?{...t,enabled:!t.enabled}:t))},[]),J=(0,l.useCallback)(e=>{let t={基礎分析:["ma5","ma10","ma20"],短線交易:["ma5","ma10","rsi_14","k_value","d_value"],趨勢分析:["ma20","ma60","macd","dif","bb_upper","bb_middle","bb_lower"],全面分析:["ma5","ma10","ma20","rsi_14","macd","k_value","d_value"]}[e]||[];V(e=>e.map(e=>({...e,enabled:t.includes(e.key)})))},[]),G=(0,l.useCallback)(()=>{V(e=>e.map(e=>({...e,enabled:!1})))},[]);return K.length>0?(0,r.jsx)("div",{className:"relative bg-white rounded-lg shadow-sm border border-red-200 overflow-hidden ".concat(N?"fixed inset-0 z-[9999] m-0 rounded-none shadow-lg":""),children:(0,r.jsx)("div",{className:"flex items-center justify-center p-8",style:{height:"".concat(c,"px")},children:(0,r.jsxs)("div",{className:"text-center max-w-md",children:[(0,r.jsx)(f.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"圖表數據錯誤"}),(0,r.jsx)("div",{className:"text-sm text-red-600 mb-4",children:K.map((e,t)=>(0,r.jsxs)("div",{className:"mb-1",children:["• ",e]},t))}),(0,r.jsx)("button",{onClick:()=>{I([]),R([]),V(e=>[...e])},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"重試"})]})})}):O?(0,r.jsxs)("div",{className:"relative bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden ".concat(N?"fixed inset-0 z-[9999] m-0 rounded-none shadow-lg":""),children:[L.length>0&&(0,r.jsx)("div",{className:"bg-yellow-50 border-b border-yellow-200 px-4 py-2",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(f.A,{className:"w-4 h-4 text-yellow-500 mt-0.5 mr-2 flex-shrink-0"}),(0,r.jsxs)("div",{className:"text-xs text-yellow-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"數據品質提醒:"}),"發現 ",L.length," 個需要注意的數據問題。",(0,r.jsxs)("button",{onClick:()=>F(!U),className:"ml-2 underline hover:no-underline",children:[U?"隱藏":"查看","詳情"]}),U&&(0,r.jsxs)("div",{className:"mt-2 max-h-24 overflow-y-auto text-xs bg-yellow-100 p-2 rounded",children:[L.slice(0,8).map((e,t)=>(0,r.jsxs)("div",{className:"mb-1 leading-relaxed",children:["• ",e]},t)),L.length>8&&(0,r.jsxs)("div",{className:"font-medium text-yellow-800",children:["... 及其他 ",L.length-8," 個問題"]}),(0,r.jsxs)("div",{className:"mt-2 pt-2 border-t border-yellow-200 text-yellow-600",children:[(0,r.jsx)("strong",{children:"說明:"})," OHLC價格邏輯錯誤已自動修正，不會影響圖表顯示"]})]})]})]})}),(0,r.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,r.jsx)(v.A,{className:"h-5 w-5 text-gray-600"})}),(0,r.jsx)("h3",{className:"text-2xl font-semibold text-gray-900",children:o}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["1d"===g?"日線":"小時線"," • ",a.length," 筆數據 • ",(e=>{if(!e||0===e.length)return"--";let t=e=>{if(!e)return"--";let t=new Date(e.date);if(isNaN(t.getTime()))return"--";let a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");if("1d"===g)return"".concat(a,"-").concat(r,"-").concat(l);{let e=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(l," ").concat(e,":").concat(s)}};return"".concat(t(e[0])," ~ ").concat(t(e[e.length-1]))})(a)]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>_(!C),className:"px-3 py-2 text-sm font-medium rounded-md transition-colors ".concat(C?"bg-gray-900 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"技術指標設定"}),(0,r.jsx)("button",{onClick:()=>k(!N),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",title:N?"退出全屏":"進入全屏",children:N?(0,r.jsx)(w.A,{className:"h-4 w-4"}):(0,r.jsx)(j.A,{className:"h-4 w-4"})})]})]})}),(0,r.jsx)(n.N,{children:C&&(0,r.jsx)(s.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"border-b border-gray-200 bg-white",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"快速設定:"}),["基礎分析","短線交易","趨勢分析","全面分析"].map(e=>(0,r.jsx)("button",{onClick:()=>J(e),className:"px-3 py-1 text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md transition-colors",children:e},e)),(0,r.jsx)("button",{onClick:G,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-md transition-colors",children:"全部關閉"})]})}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{className:"flex gap-2",children:Object.keys(P).map(e=>(0,r.jsx)("button",{onClick:()=>A(e),className:"px-3 py-1 text-sm rounded-md transition-colors ".concat(S===e?"bg-gray-900 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e},e))})}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:null==(t=P[S])?void 0:t.map(e=>(0,r.jsxs)("label",{className:"flex flex-col items-start p-3 rounded-md border cursor-pointer transition-colors ".concat(e.enabled?"border-gray-900 bg-gray-50":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:()=>z(e.key),className:"sr-only"}),(0,r.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name})]}),e.description&&(0,r.jsx)("span",{className:"mt-1 text-xs text-gray-500",children:e.description})]},e.key))})]})})}),(0,r.jsxs)("div",{className:"p-4 relative",children:[D&&T&&(0,r.jsxs)("div",{className:"absolute z-10 bg-white/95 border border-gray-200 rounded shadow-lg px-4 py-2 text-xs text-gray-800 pointer-events-none min-w-[140px] backdrop-blur-sm",style:{left:"calc(".concat(T.x,"px + 24px)"),top:"calc(".concat(T.y,"px + 12px)"),maxWidth:"220px"},children:[(0,r.jsxs)("div",{children:["日期: ",((e,t)=>{let a=new Date(e);if(isNaN(a.getTime()))return e;let r=e=>e.toString().padStart(2,"0"),l=a.getFullYear(),s=r(a.getMonth()+1),n=r(a.getDate());if("1d"===t)return"".concat(l,"-").concat(s,"-").concat(n);{let e=r(a.getHours()),t=r(a.getMinutes());return"".concat(l,"-").concat(s,"-").concat(n," ").concat(e,":").concat(t)}})(D.date,g)]}),(0,r.jsxs)("div",{children:["開盤: ",D.open]}),(0,r.jsxs)("div",{children:["最高: ",D.high]}),(0,r.jsxs)("div",{children:["最低: ",D.low]}),(0,r.jsxs)("div",{children:["收盤: ",D.close]}),void 0!==D.volume&&(0,r.jsxs)("div",{children:["成交量: ",D.volume.toLocaleString()]}),i&&H.filter(e=>e.enabled).length>0&&(0,r.jsxs)("div",{className:"mt-2 border-t pt-1 border-gray-200",children:[(0,r.jsx)("div",{className:"font-semibold text-gray-700 mb-1",children:"技術指標"}),(()=>{let e=a.findIndex(e=>e.date===D.date);return H.filter(e=>e.enabled).slice(0,5).map(t=>{var l;let s=i[t.key],n=e-(a.length-(null!=(l=null==s?void 0:s.length)?l:0)),o=n>=0&&s?s[n]:void 0;return(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 rounded-full",style:{background:t.color}}),(0,r.jsxs)("span",{children:[t.name,":"]}),(0,r.jsx)("span",{children:void 0!==o?Number(o).toFixed(2):"--"})]},t.key)})})()]})]}),(0,r.jsx)("div",{ref:x,style:{height:N?"calc(100vh - 150px)":"".concat(c,"px"),width:"100%"},className:"bg-white rounded border border-gray-100"})]}),(0,r.jsx)("div",{className:"bg-gray-50 px-6 py-2 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["數據點: ",(null==O?void 0:O.candleData.length)||0," | 成交量: ",(null==O?void 0:O.volumeData.length)||0," | 週期: ","1d"===g?"日線":"小時線",L.length>0&&" | 警告: ".concat(L.length," 個")]}),(0,r.jsx)("div",{className:"text-center text-[12px] select-none",children:"Charting By TradingView Lightweight Charts"}),H.filter(e=>e.enabled).length>0&&(0,r.jsxs)("span",{children:["啟用指標: ",H.filter(e=>e.enabled).length]})]})})]}):(0,r.jsx)("div",{className:"flex items-center justify-center bg-white rounded-lg border border-gray-200 shadow-sm",style:{height:"".concat(c,"px")},children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(v.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"暫無圖表數據"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"請提供有效的價格數據"})]})})},k=e=>{let{data:t,technicalData:a,symbol:l,timeframe:s}=e;return(0,r.jsx)(N,{data:t,technicalData:a,title:"".concat(l),height:600,showVolume:!0,timeframe:s,theme:"light"})};var C=a(2815),_=a(3946),S=a(1990),A=a(8408),D=a(1545);let M=[{key:"datetime",name:"時間",type:"datetime",width:"w-40"},{key:"open_price",name:"開盤",type:"price",width:"w-24"},{key:"high_price",name:"最高",type:"price_high",width:"w-24"},{key:"low_price",name:"最低",type:"price_low",width:"w-24"},{key:"close_price",name:"收盤",type:"price_close",width:"w-24"},{key:"volume",name:"成交量",type:"volume",width:"w-32"},{key:"rsi_5",name:"RSI(5)",type:"indicator",width:"w-20"},{key:"rsi_7",name:"RSI(7)",type:"indicator",width:"w-20"},{key:"rsi_10",name:"RSI(10)",type:"indicator",width:"w-20"},{key:"rsi_14",name:"RSI(14)",type:"indicator",width:"w-20"},{key:"rsi_21",name:"RSI(21)",type:"indicator",width:"w-20"},{key:"dif",name:"DIF",type:"indicator",width:"w-20"},{key:"macd",name:"MACD",type:"indicator",width:"w-20"},{key:"macd_histogram",name:"MACD Histogram",type:"indicator",width:"w-20"},{key:"rsv",name:"RSV",type:"indicator",width:"w-20"},{key:"k_value",name:"K值",type:"indicator",width:"w-20"},{key:"d_value",name:"D值",type:"indicator",width:"w-20"},{key:"j_value",name:"J值",type:"indicator",width:"w-20"},{key:"ma5",name:"MA5",type:"indicator",width:"w-20"},{key:"ma10",name:"MA10",type:"indicator",width:"w-20"},{key:"ma20",name:"MA20",type:"indicator",width:"w-20"},{key:"ma60",name:"MA60",type:"indicator",width:"w-20"},{key:"ema12",name:"EMA12",type:"indicator",width:"w-20"},{key:"ema26",name:"EMA26",type:"indicator",width:"w-20"},{key:"bb_upper",name:"布林上軌",type:"indicator",width:"w-20"},{key:"bb_middle",name:"布林中軌",type:"indicator",width:"w-20"},{key:"bb_lower",name:"布林下軌",type:"indicator",width:"w-20"},{key:"atr",name:"ATR平均真實波幅",type:"indicator",width:"w-20"},{key:"cci",name:"CCI商品通道指標",type:"indicator",width:"w-20"},{key:"willr",name:"威廉指標",type:"indicator",width:"w-20"},{key:"mom",name:"動量指標",type:"indicator",width:"w-20"},{key:"pattern_signals",name:"K線形態",type:"pattern_signals",width:"w-20"}],T=e=>{let{data:t,timeframe:a,symbol:i}=e,[o,c]=(0,l.useState)("datetime"),[d,m]=(0,l.useState)("desc"),[g,x]=(0,l.useState)(1),[u,h]=(0,l.useState)(20),[y,b]=(0,l.useState)(!1),[p,f]=(0,l.useState)(["datetime","open_price","high_price","low_price","close_price","volume","rsi_14","ma5","macd","k_value","d_value"]),v=(e,t)=>{if(null==e||""===e)return"—";switch(t.type){case"datetime":return w(e);case"volume":return j(e);case"price":case"price_high":case"price_low":case"price_close":return Number(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",");case"indicator":return Number(e).toFixed(3).replace(/\B(?=(\d{3})+(?!\d))/g,",");default:return String(e)}},w=e=>{try{let t=new Date(e);if(isNaN(t.getTime()))return e;let r=t.getUTCFullYear(),l=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),i=String(t.getUTCMinutes()).padStart(2,"0"),o=String(t.getUTCSeconds()).padStart(2,"0");if("1h"===a)return"".concat(r,"-").concat(l,"-").concat(s," ").concat(n,":").concat(i,":").concat(o);return"".concat(r,"-").concat(l,"-").concat(s)}catch(t){return e}},j=e=>{let t=Number(e);return isNaN(t)?"—":t>=1e9?"".concat((t/1e9).toFixed(1),"B"):t>=1e6?"".concat((t/1e6).toFixed(1),"M"):t>=1e3?"".concat((t/1e3).toFixed(1),"K"):t.toLocaleString()},N=(0,l.useMemo)(()=>[...t].sort((e,t)=>{let a=e[o],r=t[o];if(null==a)return 1;if(null==r)return -1;let l=a>r?1:-1;return"asc"===d?l:-l}),[t,o,d]),k=(0,l.useMemo)(()=>{let e=(g-1)*u;return N.slice(e,e+u)},[N,g,u]),T=Math.ceil(N.length/u),E=e=>{if(null==e)return"";let t=String(e);return/[",\n]/.test(t)?'"'+t.replace(/"/g,'""')+'"':t};return t&&0!==t.length?(0,r.jsxs)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,r.jsx)(C.A,{className:"h-5 w-5 text-gray-600"})}),(0,r.jsx)("h3",{className:"pt-2 text-2xl font-semibold text-gray-900",children:i}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["1d"===a?"日線":"小時線"," • ",t.length," 筆數據 •"," ",w(t[t.length-1].datetime)," ~"," ",w(t[0].datetime)]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:()=>b(!y),className:"p-2 rounded-lg transition-all duration-200 flex items-center ".concat(y?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-500 hover:bg-gray-200"),title:"顯示/隱藏篩選器",children:[(0,r.jsx)(_.A,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{className:"text-sm font-normal",children:"篩選"})]}),(0,r.jsxs)("button",{onClick:()=>{let e=M.filter(e=>p.includes(e.key)).map(e=>E(e.name)).join(","),t=N.map(e=>M.filter(e=>p.includes(e.key)).map(t=>E(v(e[t.key],t))).join(",")).join("\n"),a=new Blob(["\uFEFF".concat(e,"\n").concat(t)],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download="stock_data_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)},className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-all duration-200 flex items-center",title:"匯出 CSV",children:[(0,r.jsx)(S.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-sm font-normal",children:"下載 CSV"})]})]})]}),(0,r.jsx)(n.N,{children:y&&(0,r.jsx)(s.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"每頁顯示:"}),(0,r.jsxs)("select",{value:u,onChange:e=>{h(Number(e.target.value)),x(1)},className:"px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:10,children:"10"}),(0,r.jsx)("option",{value:20,children:"20"}),(0,r.jsx)("option",{value:50,children:"50"}),(0,r.jsx)("option",{value:100,children:"100"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"顯示欄位:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:M.map(e=>(0,r.jsx)("button",{onClick:()=>(e=>{f(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e.key),className:"px-2 py-1 text-xs rounded transition-colors ".concat(p.includes(e.key)?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-500"),children:e.name},e.key))})]})]})})})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsx)("tr",{children:M.filter(e=>p.includes(e.key)).map(e=>(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors ".concat(e.width||""),onClick:()=>(e=>{o===e?m("asc"===d?"desc":"asc"):(c(e),m("desc")),x(1)})(e.key),children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{children:e.name}),o===e.key&&(0,r.jsx)(s.P.div,{initial:{scale:0},animate:{scale:1},className:"text-blue-500",children:"asc"===d?(0,r.jsx)(A.A,{className:"h-3 w-3"}):(0,r.jsx)(D.A,{className:"h-3 w-3"})})]})},e.key))})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:k.map((e,t)=>(0,r.jsx)(s.P.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.02*t},className:"hover:bg-blue-50 transition-colors",children:M.filter(e=>p.includes(e.key)).map(t=>(0,r.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm ".concat("datetime"===t.type?"text-gray-700 font-medium":"indicator"===t.type?"text-blue-600 font-mono":"text-gray-700"),children:v(e[t.key],t)},t.key))},t))})]})}),T>1&&(0,r.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["顯示 ",(g-1)*u+1," -"," ",Math.min(g*u,N.length)," 筆， 共"," ",N.length," 筆記錄"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>x(1),disabled:1===g,className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"首頁"}),(0,r.jsx)("button",{onClick:()=>x(Math.max(1,g-1)),disabled:1===g,className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"上一頁"}),(0,r.jsxs)("span",{className:"px-3 py-1 text-sm",children:["第 ",g," / ",T," 頁"]}),(0,r.jsx)("button",{onClick:()=>x(Math.min(T,g+1)),disabled:g===T,className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"下一頁"}),(0,r.jsx)("button",{onClick:()=>x(T),disabled:g===T,className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"末頁"})]})]})})]}):(0,r.jsx)(s.P.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-8",children:(0,r.jsxs)("div",{className:"text-center py-20",children:[(0,r.jsx)(C.A,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"無可顯示的數據"}),(0,r.jsx)("p",{className:"text-gray-400",children:"請先查詢股票數據"})]})})},E=()=>(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-3 border-gray-300 border-t-gray-900 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"正在載入數據"}),(0,r.jsx)("p",{className:"text-gray-500",children:"請稍候，正在處理股票資訊..."})]})});var L=a(2545);let R=[{symbol:"2330",name:"台積電"},{symbol:"2454",name:"聯發科"},{symbol:"2317",name:"鴻海"},{symbol:"AAPL",name:"Apple"},{symbol:"TSLA",name:"Tesla"},{symbol:"NVDA",name:"NVIDIA"}],K=e=>{let{onQuickSelect:t}=e;return(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,r.jsxs)("div",{className:"px-8 py-16 text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(L.A,{className:"h-8 w-8 text-gray-600"})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-3",children:"開始股票分析"}),(0,r.jsx)("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"輸入股票代號，獲得專業的技術分析和投資建議"}),(0,r.jsxs)("div",{className:"max-w-lg mx-auto",children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-4",children:"熱門股票："}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:R.map(e=>(0,r.jsxs)("button",{onClick:()=>t(e.symbol),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-sm transition-colors",children:[e.symbol," ",e.name]},e.symbol))})]})]})})},I=e=>{let{error:t,onRetry:a,onClear:l}=e;return(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(f.A,{className:"h-8 w-8 text-red-500"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"查詢遇到問題"}),(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 max-w-md mx-auto",children:(0,r.jsx)("p",{className:"text-red-700 text-sm",children:t})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,r.jsx)("button",{onClick:a,className:"px-6 py-3 bg-gray-900 hover:bg-gray-800 text-white font-medium rounded-lg transition-colors",children:"重新查詢"}),(0,r.jsx)("button",{onClick:l,className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-lg transition-colors",children:"清除錯誤"})]})]})})})},U={"1d":{name:"日線",table:"stock_data_1d"},"1h":{name:"時線",table:"stock_data_1h"}};var F=a(9099),W=a(2418);let H=e=>Array.isArray(e)&&e.length>0?e[e.length-1]:void 0,V=e=>{let{technicalData:t,symbol:a,timeframe:s,close_price:n,volume:i,loading:o=!1,candlestickData:c}=e,d=(0,F.useRouter)(),m=(0,l.useMemo)(()=>({RSI:()=>H(null==t?void 0:t.rsi_14),MACD:()=>H(null==t?void 0:t.macd),DIF:()=>H(null==t?void 0:t.dif),DEA:()=>{let e=H(null==t?void 0:t.dif),a=H(null==t?void 0:t.macd_histogram);return void 0!==e&&void 0!==a?e-a:void 0},MACDHist:()=>H(null==t?void 0:t.macd_histogram),K:()=>H(null==t?void 0:t.k_value),D:()=>H(null==t?void 0:t.d_value),J:()=>H(null==t?void 0:t.j_value),MA5:()=>H(null==t?void 0:t.ma5),MA10:()=>H(null==t?void 0:t.ma10),MA20:()=>H(null==t?void 0:t.ma20),MA60:()=>H(null==t?void 0:t.ma60),BollUpper:()=>H(null==t?void 0:t.bb_upper),BollMiddle:()=>H(null==t?void 0:t.bb_middle),BollLower:()=>H(null==t?void 0:t.bb_lower),Close:()=>"number"==typeof n?n:void 0,Volume:()=>"number"==typeof i?i:void 0,AvgVol:()=>{if(Array.isArray(c)&&c.length>0){let e=c.map(e=>e.volume).filter(e=>"number"==typeof e);if(e.length>=20)return e.slice(-20).reduce((e,t)=>e+t,0)/20}},VolRatio:()=>{if(Array.isArray(c)&&c.length>0){let e=c.map(e=>e.volume).filter(e=>"number"==typeof e),t=e.length>0?e[e.length-1]:void 0,a=e.length>=20?e.slice(-20).reduce((e,t)=>e+t,0)/20:void 0;if("number"==typeof t&&"number"==typeof a&&0!==a)return t/a}},WILLR:()=>H(null==t?void 0:t.willr),ATR:()=>H(null==t?void 0:t.atr),CCI:()=>H(null==t?void 0:t.cci),MOM:()=>H(null==t?void 0:t.mom),Support:()=>{let e;if(Array.isArray(c)&&c.length>0){let e=c.map(e=>e.low).filter(e=>"number"==typeof e);if(e.length>0)return Math.min(...e.slice(-20))}for(let a of["low","lows","low_price","Low","lowPrices"])if(Array.isArray(null==t?void 0:t[a])){e=t[a];break}if(e&&0!==e.length)return Math.min(...e.slice(-20))},Resistance:()=>{let e;if(Array.isArray(c)&&c.length>0){let e=c.map(e=>e.high).filter(e=>"number"==typeof e);if(e.length>0)return Math.max(...e.slice(-20))}for(let a of["high","highs","high_price","High","highPrices"])if(Array.isArray(null==t?void 0:t[a])){e=t[a];break}if(e&&0!==e.length)return Math.max(...e.slice(-20))}}),[t,n,c,i]),g=(0,l.useMemo)(()=>{let e=m.RSI(),a=m.MACD(),r=m.DIF(),l=m.DEA(),s=m.MACDHist(),n=m.K(),i=m.D(),o=m.J(),c=m.MA5(),d=m.MA10(),g=m.MA20(),x=m.MA60(),u=m.BollUpper(),h=m.BollMiddle(),y=m.BollLower(),b=m.Close(),p=m.WILLR(),f=m.ATR(),v=m.CCI(),w=m.MOM();return[{key:"RSI",title:"RSI (14日)",value:"number"==typeof e?P(e,2):"-",valueUnit:"",...(e=>"number"!=typeof e?{tag:"-",tagColor:"bg-gray-100 text-gray-400",signal:"-",signalColor:"text-gray-400"}:e>70?{tag:"超買",tagColor:"bg-orange-200 text-orange-700",signal:"偏空",signalColor:"text-red-500"}:e>60?{tag:"接近超買",tagColor:"bg-yellow-200 text-yellow-800",signal:"中性",signalColor:"text-gray-400"}:e<30?{tag:"超賣",tagColor:"bg-blue-200 text-blue-700",signal:"偏多",signalColor:"text-green-500"}:e<40?{tag:"接近超賣",tagColor:"bg-gray-100 text-gray-400",signal:"中性",signalColor:"text-gray-400"}:{tag:"正常",tagColor:"bg-gray-100 text-gray-400",signal:"中性",signalColor:"text-gray-400"})(e),desc:"標準區間: 30-70 \n 超買線: 70+ | 超賣線: 30-"},{key:"MACD",title:"MACD",value:"number"==typeof a?P(a,2):"-",valueUnit:"",...(e=>"number"!=typeof e?{tag:"-",tagColor:"bg-gray-100 text-gray-400",signal:"-",signalColor:"text-gray-400"}:e>0?{tag:"看漲信號",tagColor:"bg-green-100 text-green-700",signal:"偏多",signalColor:"text-green-500"}:e<0?{tag:"看跌信號",tagColor:"bg-red-100 text-red-700",signal:"偏空",signalColor:"text-red-500"}:{tag:"無信號",tagColor:"bg-gray-100 text-gray-400",signal:"中性",signalColor:"text-gray-400"})(a),desc:"DIF: ".concat("number"==typeof r?P(r,1):"-"," | DEA: ").concat("number"==typeof l?P(l,1):"-","\n柱狀圖: ").concat("number"==typeof s?P(s,1):"-")},{key:"KD",title:"KD指標",value:"number"==typeof n&&"number"==typeof i?"K:".concat(P(n,0)," D:").concat(P(i,0)):"-",valueUnit:"",tag:"number"==typeof n&&"number"==typeof i?n>80&&i>80?"超買":n<20&&i<20?"超賣":n>i?"黃金交叉":"死亡交叉":"-",tagColor:"number"==typeof n&&"number"==typeof i?n>80&&i>80?"bg-orange-100 text-orange-700":n<20&&i<20?"bg-blue-100 text-blue-700":n>i?"bg-green-100 text-green-700":"bg-red-100 text-red-700":"bg-gray-100 text-gray-400",signal:"number"==typeof n&&"number"==typeof i?n>i?"偏多":"偏空":"中性",signalColor:"number"==typeof n&&"number"==typeof i?n>i?"text-green-500":"text-red-500":"text-gray-400",desc:"K值: ".concat("number"==typeof n?P(n,1):"-"," | D值: ").concat("number"==typeof i?P(i,1):"-"," \nJ值: ").concat("number"==typeof o?P(o,1):"-")},{key:"MA20",title:"移動平均線 (20日)",value:"number"==typeof g?P(g,2):"-",valueUnit:"",tag:"number"==typeof g&&"number"==typeof x&&g>x?"站上均線":"number"==typeof g&&"number"==typeof x&&g<x?"跌破均線":"number"==typeof g&&"number"==typeof x?"無信號":"-",tagColor:"number"==typeof g&&"number"==typeof x&&g>x?"bg-green-100 text-green-700":"number"==typeof g&&"number"==typeof x&&g<x?"bg-red-100 text-red-700":"bg-gray-100 text-gray-400",signal:"number"==typeof g&&"number"==typeof x?g>x?"偏多":"偏空":"中性",signalColor:"number"==typeof g&&"number"==typeof x?g>x?"text-green-500":"text-red-500":"text-gray-400",desc:"5日: ".concat("number"==typeof c?P(c,0):"-"," | 10日: ").concat("number"==typeof d?P(d,0):"-","\n60日: ").concat("number"==typeof x?P(x,0):"-")},{key:"BOLL",title:"布林通道",value:"number"==typeof u&&"number"==typeof h&&"number"==typeof y?"上軌: ".concat(P(u,2)):"-",valueUnit:"",tag:(()=>{if("number"!=typeof b||"number"!=typeof u||"number"!=typeof y||"number"!=typeof h)return"-";let e=u-y;if(0===e)return"頻道收斂";if(e<0)return"資料異常";let t=Math.abs(b-u)/e,a=Math.abs(b-y)/e;return b>u?"突破上軌":b<y?"跌破下軌":t<.02?"靠近上軌":a<.02?"靠近下軌":b>h?"站上中軌":b<h?"跌破中軌":"區間內"})(),tagColor:(()=>{if("number"!=typeof b||"number"!=typeof u||"number"!=typeof y||"number"!=typeof h)return"bg-gray-100 text-gray-400";let e=u-y;return 0===e?"bg-yellow-100 text-yellow-700":b>u?"bg-orange-200 text-orange-700":b<y?"bg-blue-200 text-blue-700":Math.abs(b-u)/e<.02?"bg-orange-100 text-orange-700":Math.abs(b-y)/e<.02?"bg-blue-100 text-blue-700":b>h?"bg-green-100 text-green-700":b<h?"bg-red-100 text-red-700":"bg-gray-100 text-gray-400"})(),signal:(()=>{if("number"!=typeof b||"number"!=typeof u||"number"!=typeof y||"number"!=typeof h)return"-";let e=u-y;return 0===e?"觀望":b>u?"偏多":b<y?"偏空":Math.abs(b-u)/e<.02?"偏多":Math.abs(b-y)/e<.02?"偏空":b>h?"偏多":b<h?"偏空":"中性"})(),signalColor:(()=>{if("number"!=typeof b||"number"!=typeof u||"number"!=typeof y||"number"!=typeof h)return"text-gray-400";let e=u-y;return 0===e?"text-yellow-500":b>u?"text-orange-500":b<y?"text-blue-500":Math.abs(b-u)/e<.02?"text-orange-400":Math.abs(b-y)/e<.02?"text-blue-400":b>h?"text-green-500":b<h?"text-red-500":"text-gray-400"})(),desc:(()=>{if("number"!=typeof u||"number"!=typeof h||"number"!=typeof y)return"-";let e=u-y,t=e>=0?P(e,2):"-",a=e<2?"收斂":e>10?"擴張":"正常";return"中軌: ".concat(P(h,2)," | 下軌: ").concat(P(y,2),"\n頻道寬度: ").concat(t," (").concat(a,")")})()},{key:"WILLR",title:"威廉指標 (W%R)",value:"number"==typeof p?P(p,2):"-",valueUnit:"",tag:"number"!=typeof p?"-":p<-80?"超賣":p>-20?"超買":"正常",tagColor:"number"!=typeof p?"bg-gray-100 text-gray-400":p<-80?"bg-blue-100 text-blue-700":p>-20?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-400",signal:"number"!=typeof p?"-":p<-80?"偏多":p>-20?"偏空":"中性",signalColor:"number"!=typeof p?"text-gray-400":p<-80?"text-green-500":p>-20?"text-red-500":"text-gray-400",desc:"超賣區: -80以下 \n 超買區: -20以上"},{key:"ATR",title:"ATR 平均真實波幅",value:"number"==typeof f?P(f,2):"-",valueUnit:"",tag:"number"!=typeof f?"-":f>2?"波動大":f<1?"波動小":"正常",tagColor:"number"!=typeof f?"bg-gray-100 text-gray-400":f>2?"bg-orange-100 text-orange-700":f<1?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-400",signal:"number"!=typeof f?"-":f>2?"高波動":f<1?"低波動":"中性",signalColor:"number"!=typeof f?"text-gray-400":f>2?"text-orange-500":f<1?"text-blue-500":"text-gray-400",desc:"ATR數值越大代表波動越大 \n 常用於風險管理。"},{key:"CCI",title:"CCI 順勢指標",value:"number"==typeof v?P(v,2):"-",valueUnit:"",tag:"number"!=typeof v?"-":v>100?"超買":v<-100?"超賣":"正常",tagColor:"number"!=typeof v?"bg-gray-100 text-gray-400":v>100?"bg-orange-100 text-orange-700":v<-100?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-400",signal:"number"!=typeof v?"-":v>100?"偏空":v<-100?"偏多":"中性",signalColor:"number"!=typeof v?"text-gray-400":v>100?"text-red-500":v<-100?"text-green-500":"text-gray-400",desc:"CCI>100超買，<-100超賣 \n 常用於判斷趨勢強弱。"},{key:"MOM",title:"MOM 動量指標",value:"number"==typeof w?P(w,2):"-",valueUnit:"",tag:"number"!=typeof w?"-":w>0?"動能上升":w<0?"動能下降":"持平",tagColor:"number"!=typeof w?"bg-gray-100 text-gray-400":w>0?"bg-green-100 text-green-700":w<0?"bg-red-100 text-red-700":"bg-gray-100 text-gray-400",signal:"number"!=typeof w?"-":w>0?"偏多":w<0?"偏空":"中性",signalColor:"number"!=typeof w?"text-gray-400":w>0?"text-green-500":w<0?"text-red-500":"text-gray-400",desc:"動量>0為上升趨勢，<0為下降趨勢 \n 常用於捕捉趨勢轉折。"},{key:"EMA26",title:"EMA (26日)",value:(()=>{let e=H(null==t?void 0:t.ema26);return"number"==typeof e?P(e,2):"-"})(),valueUnit:"",tag:(()=>{let e=H(null==t?void 0:t.ema26),a=m.Close();return"number"!=typeof e||"number"!=typeof a?"-":a>e?"站上EMA26":a<e?"跌破EMA26":"持平"})(),tagColor:(()=>{let e=H(null==t?void 0:t.ema26),a=m.Close();return"number"!=typeof e||"number"!=typeof a?"bg-gray-100 text-gray-400":a>e?"bg-green-100 text-green-700":a<e?"bg-red-100 text-red-700":"bg-gray-100 text-gray-400"})(),signal:(()=>{let e=H(null==t?void 0:t.ema26),a=m.Close();return"number"!=typeof e||"number"!=typeof a?"-":a>e?"偏多":a<e?"偏空":"中性"})(),signalColor:(()=>{let e=H(null==t?void 0:t.ema26),a=m.Close();return"number"!=typeof e||"number"!=typeof a?"text-gray-400":a>e?"text-green-500":a<e?"text-red-500":"text-gray-400"})(),desc:"EMA26加權移動平均線 \n 常用於確認趨勢方向。"},{key:"Support",title:"支撐位 (近20日低點)",value:(()=>{let e=m.Support();return"number"==typeof e?P(e,2):"-"})(),valueUnit:"",tag:"支撐",tagColor:"bg-blue-100 text-blue-700",signal:"",signalColor:"text-blue-500",desc:"近20日最低價 \n 常用於判斷下檔支撐區。"},{key:"Resistance",title:"阻力位 (近20日高點)",value:(()=>{let e=m.Resistance();return"number"==typeof e?P(e,2):"-"})(),valueUnit:"",tag:"阻力",tagColor:"bg-orange-100 text-orange-700",signal:"",signalColor:"text-orange-500",desc:"近20日最高價 \n 常用於判斷上檔壓力區。"},{key:"Volume",title:"成交量",value:(()=>{let e=m.Volume();return"number"==typeof e?O(e):"-"})(),valueUnit:"",tag:(()=>{let e=m.VolRatio();return"number"!=typeof e?"-":e>1.5?"爆量":e<.7?"量縮":"正常"})(),tagColor:(()=>{let e=m.VolRatio();return"number"!=typeof e?"bg-gray-100 text-gray-400":e>1.5?"bg-orange-100 text-orange-700":e<.7?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-400"})(),signal:(()=>{let e=m.VolRatio();return"number"!=typeof e?"-":e>1.5?"偏多":e<.7?"偏空":"中性"})(),signalColor:(()=>{let e=m.VolRatio();return"number"!=typeof e?"text-gray-400":e>1.5?"text-orange-500":e<.7?"text-blue-500":"text-gray-400"})(),desc:(()=>{let e=m.AvgVol(),t=m.VolRatio();return"20日均量: ".concat("number"==typeof e?O(e):"-","\n量能比: ").concat("number"==typeof t?P(t,2):"-")})()}]},[m,t]),x=[],u=0;for(;u<g.length;)if(g.length-u==4){x.push(g.slice(u,u+4));break}else x.push(g.slice(u,u+3)),u+=3;return o?(0,r.jsx)("div",{className:"bg-white rounded-lg p-4 shadow text-gray-500 text-center mt-2 animate-pulse",children:"技術指標載入中..."}):t&&0!==Object.keys(t).length?(0,r.jsxs)("div",{className:"flex flex-col gap-4 mt-4",children:[(0,r.jsxs)("div",{className:"flex items-center text-xl font-semibold text-gray-800 mt-2 mb-2 justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(v.A,{className:"inline-block w-6 h-6 mr-1 text-gray-500"}),a," 技術分析 -"," ","1d"===s?"日線":"1h"===s?"小時線":"",(0,r.jsx)("span",{className:"text-gray-400 text-sm font-normal ml-2",children:"- Sparkline only shows last 20 data points."})]}),(0,r.jsxs)("button",{type:"button",className:"ml-4 px-4 py-1.5 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-semibold shadow transition-colors duration-150 flex items-center gap-1",onClick:()=>{d.push("/market-analysis/trade-signals")},children:[(0,r.jsx)(L.A,{className:"w-5 h-6 mr-1"}),"進階交易訊號分析"]})]}),x.map((e,a)=>(0,r.jsx)("div",{className:3===a?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2":"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-5 shadow-lg hover:shadow-2xl transition-shadow duration-200 border border-gray-100 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"text-xs font-semibold uppercase text-gray-500 tracking-wider",children:[e.title,(0,r.jsx)("span",{className:"ml-3 text-xs ".concat(e.signalColor," font-bold"),children:e.signal})]}),(0,r.jsx)("div",{className:"px-2.5 py-0.5 rounded-full text-xs font-semibold flex items-center ".concat(e.tagColor),children:e.tag})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2 w-full",children:[(0,r.jsxs)("div",{className:"flex items-baseline",children:[(0,r.jsx)("span",{className:"text-2xl font-extrabold text-gray-800",children:e.value}),e.valueUnit&&(0,r.jsx)("span",{className:"text-sm font-medium text-gray-400 ml-1",children:e.valueUnit})]}),(0,r.jsx)("div",{className:"h-8 w-32 flex-shrink-0 flex items-center justify-end",children:(0,r.jsx)(W.Sparklines,{data:(()=>{if("Support"===e.key&&Array.isArray(c))return c.map(e=>e.low).filter(e=>"number"==typeof e).slice(-20);if("Resistance"===e.key&&Array.isArray(c))return c.map(e=>e.high).filter(e=>"number"==typeof e).slice(-20);if("Volume"===e.key&&Array.isArray(c))return c.map(e=>e.volume).filter(e=>"number"==typeof e).slice(-20);let a={RSI:"rsi_14",MACD:"macd",KD:"k_value",MA20:"ma20",BOLL:"bb_middle",WILLR:"willr",ATR:"atr",CCI:"cci",MOM:"mom",EMA26:"ema26"}[e.key];return a&&t&&Array.isArray(t[a])?t[a].slice(-20):[]})(),svgHeight:32,svgWidth:120,children:(0,r.jsx)(W.SparklinesLine,{color:"text-green-500"===e.signalColor?"green":"text-red-500"===e.signalColor?"red":"text-blue-500"===e.signalColor||"text-blue-400"===e.signalColor?"blue":"text-purple-500"===e.signalColor?"purple":"text-orange-500"===e.signalColor?"orange":"text-yellow-500"===e.signalColor?"yellow":"gray",style:{fill:"none"}})})})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 whitespace-pre-line line-clamp-2",children:e.desc})]},e.key))},a))]}):(0,r.jsx)("div",{className:"bg-white rounded-lg p-4 shadow text-gray-500 text-center mt-2",children:"無技術指標資料"})},P=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"!=typeof e||isNaN(e)?"-":e.toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:t})},O=e=>"number"!=typeof e||isNaN(e)?"-":e>=1e9?(e/1e9).toLocaleString("en-US",{maximumFractionDigits:3})+"B":e>=1e6?(e/1e6).toLocaleString("en-US",{maximumFractionDigits:3})+"M":e>=1e3?(e/1e3).toLocaleString("en-US",{maximumFractionDigits:3})+"K":e.toLocaleString("en-US");var B=a(2156),z=a(3324),J=a(692),G=a(4587),Y=a.n(G);let q=(0,l.memo)(e=>{let{pattern:t,description:a,englishName:s,imageUrl:n,zoomPattern:i,setZoomPattern:o}=e,[c,d]=(0,l.useState)(!1);return(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-md border border-gray-100 p-6 flex flex-row items-center transition-shadow duration-300 hover:shadow-xl min-h-[140px]",children:[(0,r.jsxs)("div",{className:"flex-1 flex flex-col justify-center pr-4",children:[(0,r.jsx)("span",{className:"text-xl font-bold text-gray-800 mb-1",children:t}),s&&(0,r.jsx)("span",{className:"text-xs text-gray-500 mb-2",children:s}),(0,r.jsx)("div",{className:"text-gray-700 text-sm leading-relaxed min-h-[48px]",children:a||"此形態暫無詳細說明。"})]}),(0,r.jsxs)("div",{className:"flex-shrink-0 flex items-center justify-center w-28 h-28 relative",children:[c?(0,r.jsx)(B.A,{className:"h-16 w-16 text-gray-300 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"}):(0,r.jsx)(Y(),{src:n,alt:t+" 圖例",width:96,height:96,className:"max-h-24 max-w-24 object-contain rounded-lg shadow border border-gray-200 bg-white cursor-zoom-in",style:{display:"block"},onClick:()=>o(t),onError:()=>d(!0)}),i===t&&(0,r.jsx)("div",{className:"pattern-zoom-popover absolute z-40 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white/95 rounded-xl shadow-2xl border-4 border-white flex items-center justify-center cursor-zoom-out",style:{minWidth:"200px",minHeight:"200px",maxWidth:"320px",maxHeight:"320px"},onClick:()=>o(null),children:(0,r.jsx)(Y(),{src:n,alt:t+" 放大圖例",width:288,height:288,className:"max-h-72 max-w-72 object-contain rounded-xl"})})]})]})});q.displayName="PatternCard";let X={兩隻烏鴉:"第一天長陽，第二天高開收陰，第三天再次高開繼續收陰，收盤比前一日收盤價低，預示股價下跌。",三隻烏鴉:"連續三根陰線，每日收盤價都下跌且接近最低價，每日開盤價都在上根K線實體內，預示股價下跌。",南方三星:"三日K線皆陰，第一日有長下影線，第二日K線整體小於第一日，第三日無下影線實體信號，成交價格都在第一日振幅之內，預示下跌趨勢反轉，股價上升。",三白兵:"三日K線皆陽，每日收盤價變高且接近最高價，開盤價在前一日實體上半部，預示股價上升。",大敵當前:"三日都收陽，每日收盤價都比前一日高，開盤價都在前一日實體以內，實體變短，上影線變長。",捉腰帶線:"下跌趨勢中，第一日陰線，第二日開盤價為最低價，陽線，收盤價接近最高價，預示價格上漲。",脫離:"以看漲脫離為例，下跌趨勢中，第一日長陰線，第二日跳空陰線，延續趨勢開始震盪，第五日長陽線，收盤價在第一天收盤價與第二天開盤價之間，預示價格上漲。",藏嬰吞沒:"下跌趨勢中，前兩日陰線無影線，第二日開盤、收盤價皆低於第二日，第三日倒錘頭，第四日開盤價高於前一日最高價，收盤價低於前一日最低價，預示著底部反轉。",反擊線:"二日K線模式，與分離線類似。",烏雲蓋頂:"第一日長陽，第二日開盤價高於前一日最高價，收盤價處於前一日實體中部以下，預示著股價下跌。",十字:"開盤價與收盤價基本相同。",十字星:"開盤價與收盤價基本相同，上下影線不會很長，預示著當前趨勢反轉。",蜻蜓十字:"開盤後價格一路走低，之後收復，收盤價與開盤價相同，預示趨勢反轉。",十字暮星:"基本模式為暮星，第二日收盤價和開盤價相同，預示頂部反轉。",暮星:"與晨星相反，上升趨勢中,第一日陽線，第二日價格振幅較小，第三日陰線，預示頂部反轉。",缺口上漲:"上升趨勢向上跳空，下跌趨勢向下跳空,第一日與第二日有相同開盤價，實體長度差不多，則趨勢持續。",墓碑十字:"開盤價與收盤價相同，上影線長，無下影線，預示底部反轉。",錘頭:"實體較短，無上影線，下影線大於實體長度兩倍，處於下跌趨勢底部，預示反轉",上吊線:"形狀與錘子類似，處於上升趨勢的頂部，預示著趨勢反轉。",孕線:"分多頭孕線與空頭孕線，兩者相反，以多頭孕線為例，在下跌趨勢中，第一日K線長陰，第二日開盤價收盤價在第一日價格振幅之內，為陽線，預示趨勢反轉，股價上升。",十字孕線:"與孕線類似，若第二日K線是十字線，便稱為十字孕線，預示著趨勢反轉。",風高浪大線:"具有極長的上/下影線與短的實體，預示著趨勢反轉。","Hikkake 陷阱":"與孕線類似，第二日價格在前一日實體範圍內,第三日收盤價高於前兩日，反轉失敗，趨勢繼續。","Hikkake Modified":"與Hikkake陷阱類似，上升趨勢中，第三日跳空高開；下跌趨勢中，第三日跳空低開，反轉失敗，趨勢繼續。",家鴿:"與孕線類似，不同的的是二日K線顏色相同，第二日最高價、最低價都在第一日實體之內，預示著趨勢反轉。",三胞胎烏鴉:"上漲趨勢中，三日都為陰線，長度大致相等，每日開盤價等於前一日收盤價，收盤價接近當日最低價，預示價格下跌。",頸內線:"下跌趨勢中，第一日長陰線，第二日開盤價較低，收盤價略高於第一日收盤價，陽線，實體較短，預示著下跌繼續。",倒錘頭:"上影線較長，長度為實體2倍以上，無下影線，在下跌趨勢底部，預示著趨勢反轉。",反沖形態:"與分離線類似，兩日K線為禿線，顏色相反，存在跳空缺口。","反沖-長短判斷":"與反沖形態類似，較長缺影線決定價格的漲跌。",梯形底部:"下跌趨勢中，前三日陰線，開盤價與收盤價皆低於前一日開盤、收盤價，第四日倒錘頭，第五日開盤價高於前一日開盤價，陽線，收盤價高於前幾日價格振幅，預示著底部反轉。",長腿十字:"開盤價與收盤價相同居當日價格中部，上下影線長，表達市場不確定性。",長蠟燭:"K線實體長，無上下影線。",匹配低點:"下跌趨勢中，第一日長陰線，第二日陰線，收盤價與前一日相同，預示底部確認，該價格為支撐位。",鋪墊:"上漲趨勢中，第一日陽線，第二日跳空高開影線，第三、四日短實體影線，第五日陽線，收盤價高於前四日，預示趨勢持續。",十字晨星:"基本模式為晨星，第二日K線為十字星，預示底部反轉。",晨星:"下跌趨勢，第一日陰線，第二日價格振幅較小，第三天陽線，預示底部反轉。",頸上線:"下跌趨勢中，第一日長陰線，第二日開盤價較低，收盤價與前一日最低價相同，陽線，實體較短，預示著延續下跌趨勢。",刺穿形態:"下跌趨勢中，第一日陰線，第二日收盤價低於前一日最低價，收盤價處在第一日實體上部，預示著底部反轉。",黃包車夫:"與長腿十字線類似，若實體正好處於價格振幅中點，稱為黃包車夫。",分離線:"上漲趨勢中，第一日陰線，第二日陽線，第二日開盤價與第一日相同且為最低價，預示著趨勢繼續。",射擊星:"上影線至少為實體長度兩倍，沒有下影線，預示著股價下跌。",短蠟燭:"實體短，無上下影線",紡錘線:"實體小",停滯形態:"上漲趨勢中，第二日長陽線，第三日開盤於前一日收盤價附近，短陽線，預示著上漲結束。",三明治:"第一日長陰線，第二日陽線，開盤價高於前一日收盤價，第三日開盤價高於前兩日最高價，收盤價於第一日收盤價相同。",探水竿:"大致與蜻蜓十字相同，下影線長度長。",跳空並列月缺:"分上漲和下跌，以上升為例，前兩日陽線，第二日跳空，第三日陰線，收盤價於缺口中，上升趨勢持續。",向上突破:"與頸上線類似，下跌趨勢中，第一日長陰線，第二日開盤價跳空，收盤價略低於前一日實體中部，與頸上線相比實體較長，預示著趨勢持續。",三星:"由三個十字組成，第二日十字必須高於或者低於第一日和第三日，預示著反轉。",奇特三河床:"下跌趨勢中，第一日長陰線，第二日為錘頭，最低價創新低，第三日開盤價低於第二日收盤價，收陽線，收盤價不高於第二日收盤價，預示著反轉，第二日下影線越長可能性越大。",向上跳空兩隻烏鴉:"第一日陽線，第二日跳空以高於第一日最高價開盤，收陰線，第三日開盤價高於第二日，收陰線，與第一日比仍有缺口。",光頭:"最低價低於開盤價，收盤價等於最高價，預示著趨勢持續。",光腳:"最高價高於開盤價，收盤價等於最低價，預示著趨勢持續。",上漲光頭光腳:"上下兩頭都沒有影線的實體，陽線預示著牛市持續或者熊市反轉，陰線相反。",下跌光頭光腳:"上下兩頭都沒有影線的實體，陰線預示著熊市持續或者牛市反轉，陽線相反。",三內部上漲:"三日K線模式，母子信號+長K線，以三內部上漲為例，K線為陰陽陽，第三天收盤價高於第一天開盤價，第二天K線在第一天K線內部，預示著股價上漲。",三內部下跌:"三日K線模式，母子信號+長K線，以三內部下跌為例，K線為陽陰陰，第三天收盤價低於第一天開盤價，第二天K線在第一天K線內部，預示著股價下跌。",三線打擊上漲:"四日K線模式，前三根陽線，每日收盤價都比前一日高，開盤價在前一日實體內，第四日市場高開，收盤價低於第一日開盤價，預示股價下跌。",三線打擊下跌:"四日K線模式，前三根陰線，每日收盤價都比前一日低，開盤價在前一日實體內，第四日市場低開，收盤價高於第一日開盤價，預示股價上漲。",三外部上漲:"三日K線模式，與三內部上漲和下跌類似，K線為陰陽陽，但第一日與第二日的K線形態相反，以三外部上漲為例，第一日K線在第二日K線內部，預示著股價上漲。",三外部下跌:"三日K線模式，與三內部上漲和下跌類似，K線為陽陰陰，但第一日與第二日的K線形態相反，以三外部下跌為例，第一日K線在第二日K線內部，預示著股價下跌。",棄嬰上漲:"第二日價格跳空且收十字星（開盤價與收盤價接近，最高價最低價相差不大），預示趨勢反轉，發生在頂部下跌，底部上漲。",棄嬰下跌:"第二日價格跳空且收十字星（開盤價與收盤價接近，最高價最低價相差不大），預示趨勢反轉，發生在頂部上漲，底部下跌。",上升三法:"上漲趨勢中，第一日長陽線，中間三日價格在第一日範圍內小幅震盪，第五日長陽線，收盤價高於第一日收盤價，預示股價上升。",下降三法:"下跌趨勢中，第一日長陰線，中間三日價格在第一日範圍內小幅震盪，第五日長陰線，收盤價低於第一日收盤價，預示股價下跌。",上升跳空三法:"上漲趨勢中，第一日長陽線，第二日短陽線，第三日跳空陽線，第四日陰線，開盤價與收盤價於前兩日實體內，第五日長陽線，收盤價高於第一日收盤價，預示股價上升。",下降跳空三法:"下跌趨勢中，第一日長陰線，第二日短陰線，第三日跳空陰線，第四日陽線，開盤價與收盤價於前兩日實體內，第五日長陰線，收盤價低於第一日收盤價，預示股價下跌。",多頭吞沒:"第一日為陰線，第二日陽線，第一日的開盤價和收盤價在第二日開盤價收盤價之內，但不能完全相同。",空頭吞沒:"第一日為陽線，第二日陰線，第一日的開盤價和收盤價在第二日開盤價收盤價之內，但不能完全相同。"},Z={兩隻烏鴉:"Two Crows",三隻烏鴉:"Three Black Crows",南方三星:"Three Stars in the South",三白兵:"Three White Soldiers",大敵當前:"Advance Block",捉腰帶線:"Belt Hold",脫離:"Breakaway",藏嬰吞沒:"Concealing Baby Swallow",反擊線:"Counterattack",烏雲蓋頂:"Dark Cloud Cover",十字:"Doji",十字星:"Doji Star",蜻蜓十字:"Dragonfly Doji",十字暮星:"Evening Doji Star",暮星:"Evening Star",缺口上漲:"Up-Gap Side-by-Side White Lines",墓碑十字:"Gravestone Doji",錘頭:"Hammer",上吊線:"Hanging Man",孕線:"Harami",十字孕線:"Harami Cross",風高浪大線:"High Wave Candle","Hikkake 陷阱":"Hikkake","Hikkake Modified":"Hikkake Modified",家鴿:"Homing Pigeon",三胞胎烏鴉:"Identical Three Crows",頸內線:"In-Neck Pattern",倒錘頭:"Inverted Hammer",反沖形態:"Kicking","反沖-長短判斷":"Kicking - Bull/Bear Determined by the Longer Marubozu",梯形底部:"Ladder Bottom",長腿十字:"Long-Legged Doji",長蠟燭:"Long Line Candle",匹配低點:"Matching Low",鋪墊:"Mat Hold",十字晨星:"Morning Doji Star",晨星:"Morning Star",頸上線:"On-Neck Pattern",刺穿形態:"Piercing Pattern",黃包車夫:"Rickshaw Man",分離線:"Separation Line",射擊星:"Shooting Star",短蠟燭:"Short Line Candle",紡錘線:"Spinning Top",停滯形態:"Stalled Pattern",三明治:"Stick Sandwich",探水竿:"Takuri (Dragonfly Doji with very long lower shadow)",跳空並列月缺:"Tasuki Gap",向上突破:"	Thrusting Pattern",三星:"Tristar Pattern",奇特三河床:"Unique 3 River",向上跳空兩隻烏鴉:"Upside Gap Two Crows",光頭:"Headlight",光腳:"Footlight",上漲光頭光腳:"Bullish Headlight",下跌光頭光腳:"Bearish Headlight",三內部上漲:"Three Inside Up",三內部下跌:"Three Inside Down",三線打擊上漲:"Three Line Strike Up",三線打擊下跌:"Three Line Strike Down",三外部上漲:"Three Outside Up",三外部下跌:"Three Outside Down",棄嬰上漲:"Abandoned Baby Bullish",棄嬰下跌:"Abandoned Baby Bearish",上升三法:"Rising Three Methods",下降三法:"Falling Three Methods",上升跳空三法:"Upside Gap Three Methods",下降跳空三法:"Downside Gap Three Methods",多頭吞沒:"Bullish Engulfing",空頭吞沒:"Bearish Engulfing"},Q=e=>{let{data:t,loading:a,error:s,symbol:n,timeframe:i}=e,[o,c]=(0,l.useState)(null),[d,m]=(0,l.useState)(null),g=(0,l.useMemo)(()=>t&&t.length>0?t[0]:null,[t]),x=(0,l.useMemo)(()=>g?(g.pattern_signals||"").split(/[,，]/).map(e=>e.trim()).filter(Boolean):[],[g]);return((0,l.useEffect)(()=>{x.length>0&&!o&&c(x[0])},[x,o]),a)?(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 mt-4",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)("div",{className:"h-6 w-6 bg-gray-300 rounded"}),(0,r.jsx)("div",{className:"h-6 w-32 bg-gray-300 rounded"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-300 rounded w-2/3"})]})]})}):s?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 mt-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-600",children:[(0,r.jsx)(z.A,{className:"h-6 w-6"}),(0,r.jsx)("span",{className:"font-medium",children:"載入錯誤"})]}),(0,r.jsx)("p",{className:"text-red-500 mt-2",children:s})]}):t&&0!==t.length?(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6 mt-4 hover:shadow-xl transition-shadow duration-300",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"bg-gray-500 p-2 rounded-lg",children:(0,r.jsx)(B.A,{className:"h-6 w-6 text-white"})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-800 pt-2",children:"K 線形態分析"}),0!==x.length?(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["已辨識出的型態：",x.length," 種"]}):null]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"型態辨識"}),(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-700",children:[n," \xb7 ","1d"===i?"日線":"小時線"]})]})]}),0===x.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(B.A,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"目前未辨識到明顯的 K 線形態"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map((e,t)=>(0,r.jsx)(q,{pattern:e,description:X[e]||"",englishName:Z[e],imageUrl:(e=>{let t=e.replace(/\s+/g,"");return"/kline-patterns/".concat(t,".png")})(e),zoomPattern:d,setZoomPattern:m},e+t))})]}):(0,r.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-6 mt-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(J.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-gray-600",children:"查無 K 線形態資料"})]})})};var $=a(1539);let ee=[{key:"chart",label:"圖表",icon:(0,r.jsx)(v.A,{className:"h-5 w-5 inline-block align-text-bottom"})},{key:"table",label:"數據",icon:(0,r.jsx)(C.A,{className:"h-5 w-5 inline-block align-text-bottom"})}],et=()=>{let[e,t]=(0,l.useState)({symbol:"",market:"market_stock_tw"}),[a,n]=(0,l.useState)("chart"),[i,o]=(0,l.useState)("1d"),[c,d]=(0,l.useState)("1Y"),{data:m,loading:g,error:x,stats:h,candlestickData:y,technicalData:p,refetch:f,clearError:w}=((e,t,a)=>{let[r,s]=(0,l.useState)([]),[n,i]=(0,l.useState)(!1),[o,c]=(0,l.useState)(null),d=(0,l.useRef)(e);(0,l.useEffect)(()=>{d.current=e},[e]);let m=(0,l.useCallback)(async()=>{if(!e.trim())return;i(!0),c(null);let r=U[t].table,l="\n      SELECT\n        symbol, datetime, open_price, high_price, low_price, close_price, volume,\n        rsi_5, rsi_7, rsi_10, rsi_14, rsi_21,\n        dif, macd, macd_histogram,\n        rsv, k_value, d_value, j_value,\n        ma5, ma10, ma20, ma60, ema12, ema26,\n        bb_upper, bb_middle, bb_lower,\n        atr, cci, willr, mom, pattern_signals\n      FROM [".concat(a,"].[dbo].[").concat(r,"]\n      WHERE symbol = @symbol\n      ORDER BY datetime DESC\n    ");try{let t=await fetch("/api/database/execute-query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:{database:a},query:l.trim(),params:{symbol:e.toUpperCase()}})});if(d.current!==e)return;if(!t.ok)throw Error("查詢失敗: ".concat(t.status));let r=await t.json();if(r.success)s(r.data||[]),r.data&&0!==r.data.length||c("查無資料");else throw s([]),Error(r.error||"查詢失敗")}catch(t){if(d.current!==e)return;s([]),c(t instanceof Error?t.message:"未知錯誤")}finally{d.current===e&&i(!1)}},[e,t,a]);(0,l.useEffect)(()=>{s([]),c(null),m()},[e,t,a,m]);let g=(0,l.useMemo)(()=>r.length?r.slice().reverse().filter(e=>void 0!==e.open_price&&void 0!==e.high_price&&void 0!==e.low_price&&void 0!==e.close_price&&e.datetime).map(e=>({date:e.datetime,open:Number(e.open_price),high:Number(e.high_price),low:Number(e.low_price),close:Number(e.close_price),volume:e.volume?Number(e.volume):void 0})):[],[r]),x=(0,l.useMemo)(()=>{if(!r.length)return;let e=r.slice().reverse(),t={};return["rsi_5","rsi_7","rsi_10","rsi_14","rsi_21","dif","macd","macd_histogram","k_value","d_value","j_value","ma5","ma10","ma20","ma60","ema12","ema26","bb_upper","bb_middle","bb_lower","atr","cci","willr","mom","pattern_signals"].forEach(a=>{let r=e.map(e=>{let t=e[a];return null==t||isNaN(Number(t))?null:Number(t)}).filter(e=>null!==e);r.length>0&&(t[a]=r)}),t},[r]),u=(0,l.useMemo)(()=>{if(!g.length||!r.length)return null;let e=g[g.length-1],t=r[0],a=g.length>1?g[g.length-2]:e,l=e.close-a.close,s=l/a.close*100;return{latest:e.close,change:l,changePercent:s,isRising:l>=0,high:e.high,low:e.low,volume:e.volume,open_price:e.open,open:e.open,datetime:(null==t?void 0:t.datetime)||e.date}},[g,r]);return{data:r,loading:n,error:o,stats:u,candlestickData:g,technicalData:x,refetch:(0,l.useCallback)(()=>{m()},[m]),clearError:(0,l.useCallback)(()=>{c(null)},[])}})(e.symbol,i,e.market),j=(0,l.useCallback)(e=>{t(t=>({...t,symbol:e}))},[]),N=(0,l.useCallback)(e=>{t(t=>({...t,market:e}))},[]),C=(0,l.useCallback)((e,a)=>{t({symbol:e,market:a})},[]),_=(0,l.useCallback)(e=>{o(e)},[]),S=(0,l.useCallback)(e=>{d(e)},[]),A=(0,l.useMemo)(()=>null==y?void 0:y.slice(-1)[0],[y]),D=(0,l.useCallback)(()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q,{data:m,loading:g,error:x,symbol:e.symbol,timeframe:i,market:e.market}),(0,r.jsx)(V,{technicalData:p,symbol:e.symbol,timeframe:i,open_price:null==A?void 0:A.open,high_price:null==A?void 0:A.high,low_price:null==A?void 0:A.low,close_price:null==A?void 0:A.close,volume:null==A?void 0:A.volume,loading:g,candlestickData:y})]}),[A,y,p,e.symbol,i,g,e.market,m,x]),M=(0,l.useCallback)(()=>{if(g)return(0,r.jsx)(E,{});if(x)return(0,r.jsx)(I,{error:x,onRetry:f,onClear:w});if(!m||0===m.length)return(0,r.jsx)(K,{onQuickSelect:j});switch(a){case"chart":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k,{data:y,technicalData:p,symbol:e.symbol,timeframe:i}),D()]});case"table":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T,{data:m,timeframe:i,symbol:e.symbol}),D()]});default:return null}},[g,x,m,a,y,p,e.symbol,i,f,w,j,D]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("section",{className:"relative bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center overflow-hidden shadow-2xl",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-20",children:(0,r.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"\n                  linear-gradient(rgba(59, 130, 246, 0.1) 1px, transparent 1px),\n                  linear-gradient(90deg, rgba(59, 130, 246, 0.1) 1px, transparent 1px)\n                ",backgroundSize:"50px 50px"}})}),(0,r.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full",children:[(0,r.jsx)("div",{className:"absolute top-12 left-12 w-24 h-24 bg-white opacity-5 rounded-full animate-pulse"}),(0,r.jsx)("div",{className:"absolute bottom-12 right-24 w-36 h-36 bg-white opacity-5 rounded-full animate-pulse",style:{animationDelay:"1s"}}),(0,r.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-radial from-white/10 to-transparent rounded-full"}),(0,r.jsx)("div",{className:"absolute top-24 right-12 w-4 h-4 bg-white opacity-20 rounded-full animate-bounce"}),(0,r.jsx)("div",{className:"absolute bottom-24 left-24 w-3 h-3 bg-white opacity-30 rounded-full animate-pulse",style:{animationDelay:"1.5s"}}),(0,r.jsx)("div",{className:"absolute top-48 left-1/4 w-5 h-5 bg-white opacity-15 rounded-full animate-bounce",style:{animationDelay:"2s"}}),(0,r.jsx)("div",{className:"absolute top-32 right-1/3 w-2 h-2 bg-white opacity-25 rounded-full animate-pulse",style:{animationDelay:"0.5s"}})]}),(0,r.jsx)("div",{className:"relative max-w-7xl mx-auto px-6 sm:px-8 lg:px-12 py-16 z-10 w-full",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-8",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"p-4 bg-white/10 rounded-3xl backdrop-blur-sm mr-6 group hover:bg-white/20 transition-all duration-300 shadow-lg",children:(0,r.jsx)(v.A,{className:"h-10 w-10 text-white group-hover:scale-110 transition-transform duration-300"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-4xl lg:text-5xl font-bold text-white tracking-tight leading-tight",children:"技術分析"}),(0,r.jsx)("p",{className:"text-blue-200 mt-3 text-xl font-medium",children:"深入洞察市場趨勢"})]})]}),(0,r.jsx)("p",{className:"text-blue-200 text-xl max-w-3xl leading-relaxed",children:"利用先進的技術指標和圖表模式，深入分析股票走勢，幫助投資者做出明智決策。"})]}),(0,r.jsx)("div",{className:"flex flex-col lg:items-end space-y-4",children:(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6 lg:gap-8",children:(0,r.jsxs)("div",{className:"text-center bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20 shadow-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-white",children:"yahoo"}),(0,r.jsx)("div",{className:"text-blue-200 text-sm font-medium",children:"市場數據來源"})]})})})]})})]}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[(0,r.jsx)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:(0,r.jsx)(u,{symbol:e.symbol,onSymbolChange:j,timeframe:i,onTimeframeChange:_,loading:g,dataPeriod:c,onDataPeriodChange:S,market:e.market,onMarketChange:N,onSymbolAndMarketChange:C})}),m&&m.length>0&&(0,r.jsx)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"flex justify-center mb-6",children:(0,r.jsx)("div",{className:"bg-white rounded-lg p-1 shadow-sm border border-gray-200",children:(0,r.jsx)("div",{className:"flex space-x-1",children:ee.map(e=>(0,r.jsxs)(s.P.button,{onClick:()=>n(e.key),className:"px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat(a===e.key?"bg-gray-900 text-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[(0,r.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.key))})})}),h&&m&&m.length>0&&!g&&!x?(0,r.jsx)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:(0,r.jsx)(b,{symbol:e.symbol,stats:h,timeframe:i})}):null,M()]}),(0,r.jsx)($.A,{})]})]})}},9524:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/market-analysis/stock-query",function(){return a(8923)}])}},e=>{e.O(0,[938,329,665,64,636,593,792],()=>e(e.s=9524)),_N_E=e.O()}]);