(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[364],{992:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/market-analysis/trade-signals",function(){return s(6275)}])},1539:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(7876);s(4232);var a=s(7021),l=s(9038);let n=()=>(0,r.jsxs)("footer",{className:"bg-gray-900 text-gray-300 relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-5",children:(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-blue-500/20 to-purple-500/20"})}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 relative z-10 pt-12",children:[(0,r.jsxs)("div",{className:"grid lg:grid-cols-4 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mr-4",children:(0,r.jsx)(a.A,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-white",children:"FinTech Studio"}),(0,r.jsx)("p",{className:"text-gray-400",children:"智慧金融分析平台"})]})]}),(0,r.jsx)("p",{className:"text-gray-400 leading-relaxed mb-6 max-w-md",children:"金融走勢智慧分析，讓投資更簡單。透過 AI 技術，提供即時市場分析、訊號分析和交易建議，助您做出明智的投資決策。"}),(0,r.jsx)("div",{className:"flex space-x-4",children:(0,r.jsx)("a",{href:"https://github.com/fintech-studio/financial-analysis",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center transition-colors group",children:(0,r.jsx)(l.hL4,{className:"w-5 h-5 text-gray-400 group-hover:text-white transition-colors"})})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-white font-semibold mb-6",children:"功能"}),(0,r.jsx)("ul",{className:"space-y-3",children:["市場分析","財經新聞","AI 預測","AI 助理"].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:["/market-analysis","/news","/predict","/chat"][["市場分析","財經新聞","AI 預測","AI 助理"].indexOf(e)],className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-white font-semibold mb-6",children:"支援"}),(0,r.jsx)("ul",{className:"space-y-3",children:["幫助中心","聯絡我們","隱私政策","服務條款"].map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-800 mt-8 pt-8 flex flex-col md:flex-row items-center justify-center",children:(0,r.jsxs)("p",{className:"text-gray-400 text-sm text-center",children:["\xa9 ",new Date().getFullYear()," FinTech Studio. All rights reserved."]})})]})]})},2283:(e,t,s)=>{"use strict";s.d(t,{B:()=>a});var r=s(6971);class a extends r.d{static getInstance(){return a.instance||(a.instance=new a),a.instance}logInfo(e,t){this.enableLog&&console.log("[DatabaseService] ".concat(e),t||"")}logError(e,t){this.enableLog&&console.error("[DatabaseService] ".concat(e),t||"")}getApiBaseUrl(){return window.location.origin}extractError(e){return e.error||e.message||"操作失敗"}validateConnectionConfig(e){if(!e.server)throw Error("伺服器地址不能為空");if(!e.user||!e.password)throw Error("SQL Server 驗證模式需要提供用戶名和密碼")}async testConnection(e){try{this.logInfo("開始測試數據庫連接",{server:e.server,database:e.database||"預設",user:e.user}),this.validateConnectionConfig(e);let t=this.getApiBaseUrl(),s=await fetch("".concat(t,"/api/database/test-connection"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await s.json();if(r.success)return this.logInfo("數據庫連接測試成功",r.message),r;return this.logError("數據庫連接測試失敗",r.message),r}catch(e){return this.logError("數據庫連接測試發生錯誤",e),{success:!1,message:"連接失敗：".concat(e instanceof Error?e.message:"網路錯誤")}}}async executeQuery(e,t,s){try{var r,a;if(this.logInfo("開始執行 SQL 查詢",{query:t.substring(0,100)+"..."}),!t||!t.trim())return{success:!1,error:"SQL 查詢語句不能為空"};let l=this.getApiBaseUrl(),n=await fetch("".concat(l,"/api/database/execute-query"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:e,query:t,params:s})}),i=await n.json();if(!i.success)return this.logError("SQL 查詢執行失敗",this.extractError(i)),{success:!1,error:this.extractError(i)};return this.logInfo("SQL 查詢執行成功",{recordCount:(null==(r=i.data)?void 0:r.length)||0}),{success:!0,data:i.data||[],count:(null==(a=i.data)?void 0:a.length)||0,message:i.message}}catch(e){return this.logError("SQL 查詢執行發生錯誤",e),{success:!1,error:"查詢失敗：".concat(e instanceof Error?e.message:"網路錯誤")}}}async getTableList(e){try{this.logInfo("開始獲取數據庫表列表");let t=await this.executeQuery(e,"SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' ORDER BY TABLE_NAME");if(t.success&&t.data){let e=t.data.map(e=>e.TABLE_NAME);return this.logInfo("成功獲取表列表",{tableCount:e.length}),e}{let e=this.extractError(t);if(e.includes("登入失敗"))return this.logError("登入失敗：請檢查使用者名稱、密碼，或確認帳號是否有存取該資料庫的權限。如有疑問請聯絡資料庫管理員。",e),[];return this.logError("獲取表列表失敗",e),[]}}catch(e){return this.logError("獲取表列表失敗",e),[]}}async getTableSchema(e,t){try{this.logInfo("開始獲取表結構",{tableName:t});let s=await this.executeQuery(e,"SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE, COLUMN_DEFAULT, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @tableName ORDER BY ORDINAL_POSITION",{tableName:t});if(s.success&&s.data)return this.logInfo("成功獲取表結構",{columnCount:s.data.length}),s.data;throw Error(this.extractError(s))}catch(e){throw this.logError("獲取表結構失敗",e),Error(e instanceof Error?e.message:"獲取表結構失敗")}}async getDatabaseList(e){try{this.logInfo("開始獲取資料庫列表");let t={...e,database:"master"},s=await this.executeQuery(t,"SELECT name FROM sys.databases WHERE database_id > 4 ORDER BY name");if(s.success&&s.data){let e=s.data.map(e=>e.name);return this.logInfo("成功獲取資料庫列表",{databaseCount:e.length}),e}throw Error(this.extractError(s))}catch(e){throw this.logError("獲取資料庫列表失敗",e),Error(e instanceof Error?e.message:"獲取資料庫列表失敗")}}constructor(){super(),this.enableLog=!0}}},4684:(e,t,s)=>{"use strict";s.d(t,{k5:()=>d});var r=s(4232),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=r.createContext&&r.createContext(a),n=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(this,arguments)}function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach(function(t){var r,a,l;r=e,a=t,l=s[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in r?Object.defineProperty(r,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[a]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function d(e){return t=>r.createElement(x,i({attr:o({},e.attr)},t),function e(t){return t&&t.map((t,s)=>r.createElement(t.tag,o({key:s},t.attr),e(t.child)))}(e.child))}function x(e){var t=t=>{var s,{attr:a,size:l,title:c}=e,d=function(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)s=l[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,n),x=l||t.size||"1em";return t.className&&(s=t.className),e.className&&(s=(s?s+" ":"")+e.className),r.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,d,{className:s,style:o(o({color:e.color||t.color},t.style),e.style),height:x,width:x,xmlns:"http://www.w3.org/2000/svg"}),c&&r.createElement("title",null,c),e.children)};return void 0!==l?r.createElement(l.Consumer,null,e=>t(e)):t(a)}},6275:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(7876),a=s(4232),l=s(1539),n=s(2283),i=s(294),c=s(1306);function o(e){if(!e)return"";let t=new Date(String(e));return isNaN(t.getTime())?String(e):t.toLocaleString()}function d(e){return e?e.includes("買")?{text:e,cls:"border-green-200 text-green-700 bg-white"}:e.includes("賣")?{text:e,cls:"border-red-200 text-red-700 bg-white"}:{text:e,cls:"border-gray-200 text-gray-700 bg-white"}:{text:"無訊號",cls:"border-gray-200 text-gray-600 bg-white"}}function x(e){if(null==e||""===e)return"-";let t=Number(e);return isNaN(t)?String(e):t.toLocaleString()}let u=()=>(0,r.jsx)("div",{className:"space-y-4",children:[1,2].map(e=>(0,r.jsxs)("div",{className:"p-3 rounded bg-gray-100",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-3 animate-pulse"}),(0,r.jsx)("div",{className:"h-28 bg-gray-200 rounded animate-pulse"})]},e))}),m=e=>{let{signal:t}=e,s=d(t||"");return(0,r.jsx)("span",{className:"inline-block px-3 py-1 text-sm rounded-full border ".concat(s.cls),children:s.text})},g=()=>{let[e,t]=(0,a.useState)(""),[s,g]=(0,a.useState)("1d"),[h,p]=(0,a.useState)("market_stock_tw"),[b,f]=(0,a.useState)(!1),[j,v]=(0,a.useState)(""),[y,N]=(0,a.useState)({}),[w,E]=(0,a.useState)({}),S=(0,a.useRef)(null),[C,_]=(0,a.useState)(null),[O,D]=(0,a.useState)("desc");(0,a.useEffect)(()=>{S.current&&(S.current.scrollTop=S.current.scrollHeight)},[y]),(0,a.useEffect)(()=>{let e=Object.keys(y);E(t=>{let s={...t};return e.forEach(e=>{s[e]||(s[e]={visible:!0,search:"",page:1,pageSize:10})}),Object.keys(s).forEach(t=>{e.includes(t)||delete s[t]}),s})},[y]);let k=e=>{var t;return null!=(t=w[e])?t:{visible:!0,search:"",page:1,pageSize:10}},L=(e,t)=>{E(s=>({...s,[e]:{...k(e),...t}}))},A=(0,a.useCallback)(e=>"market_crypto"===h?e.replace(RegExp("[^0-9A-Za-z_/.\\-]","g"),"").toUpperCase():e.replace(/[^0-9A-Za-z]/g,"").toUpperCase(),[h]),T=(0,a.useCallback)(async()=>{let t=A(e);if(!t)return void v("請輸入股票代號，例如 2330 或 0050");f(!0),v(""),N({});try{let e=n.B.getInstance(),r={user:"",password:"",server:"",database:h},a=[];("1d"===s||"both"===s)&&a.push({key:"1d",sql:"SELECT TOP (500) * FROM trade_signals_1d WHERE symbol = @symbol ORDER BY [datetime] DESC"}),("1h"===s||"both"===s)&&a.push({key:"1h",sql:"SELECT TOP (500) * FROM trade_signals_1h WHERE symbol = @symbol ORDER BY [datetime] DESC"});let l={};for(let s of a){let a=await e.executeQuery(r,s.sql,{symbol:t});if(!a.success){v(a.error||"查詢失敗"),f(!1);return}l[s.key]=a.data||[]}N(l)}catch(e){v(e instanceof Error?e.message:"未知錯誤")}finally{f(!1)}},[e,s,A]),M=(0,a.useCallback)(e=>{let t={},s={},r=[],a=["MA_Cross","BB_Signal","MACD_Cross","MACD_Div","RSI_Signal","KD_Signal","SR_Signal","Volume_Anomaly","EMA_Cross","CCI_Signal","WILLR_Signal","MOM_Signal","Anomaly"];for(let h of e.slice(0,200)){var l,n,i,c,d,u,m,g;let e=String(null!=(n=null!=(l=h.Trade_Signal)?l:h.signal)?n:"");e&&(t[e]=(t[e]||0)+1),a.forEach(e=>{let t=h[e];null!=t&&""!==String(t)&&"0"!==String(t)&&(s[e]=(s[e]||0)+1)}),r.push({date:o(null!=(i=h.datetime)?i:h.date),price:x(null!=(c=h.close_price)?c:h.close),signal:String(null!=(u=null!=(d=h.Trade_Signal)?d:h.signal)?u:""),strength:String(null!=(g=null!=(m=h.Signal_Strength)?m:h.strength)?g:"")})}return{counts:t,indicatorsSorted:Object.entries(s).sort((e,t)=>t[1]-e[1]),timeline:r}},[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("section",{className:"relative bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center overflow-hidden shadow-2xl",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-20",children:(0,r.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"\n                linear-gradient(rgba(255,255,255,0.06) 1px, transparent 1px),\n                linear-gradient(90deg, rgba(255,255,255,0.06) 1px, transparent 1px)\n              ",backgroundSize:"60px 60px"}})}),(0,r.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full",children:[(0,r.jsx)("div",{className:"absolute top-12 left-12 w-24 h-24 bg-white opacity-5 rounded-full animate-pulse"}),(0,r.jsx)("div",{className:"absolute bottom-12 right-24 w-36 h-36 bg-white opacity-5 rounded-full animate-pulse",style:{animationDelay:"1s"}}),(0,r.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-radial from-white/10 to-transparent rounded-full"}),(0,r.jsx)("div",{className:"absolute top-24 right-12 w-4 h-4 bg-white opacity-20 rounded-full animate-bounce"}),(0,r.jsx)("div",{className:"absolute bottom-24 left-24 w-3 h-3 bg-white opacity-30 rounded-full animate-pulse",style:{animationDelay:"1.5s"}})]}),(0,r.jsx)("div",{className:"relative max-w-7xl mx-auto px-6 sm:px-8 lg:px-12 py-16 z-10 w-full",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-8",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"p-4 bg-white/10 rounded-3xl backdrop-blur-sm mr-6 group hover:bg-white/20 transition-all duration-300 shadow-lg",children:(0,r.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,r.jsx)(c.A,{className:"h-8 w-8 text-white"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-4xl lg:text-5xl font-bold text-white tracking-tight leading-tight",children:"進階交易訊號分析"}),(0,r.jsx)("p",{className:"text-blue-100 mt-3 text-lg font-medium",children:"提供股票與加密貨幣等等的交易訊號查詢與分析工具。"})]})]}),(0,r.jsx)("p",{className:"text-blue-100 text-lg max-w-3xl leading-relaxed",children:"查詢並分析技術指標產生的交易訊號，協助投資人做出更明智的交易決策。"})]}),(0,r.jsx)("div",{className:"flex flex-col lg:items-end space-y-4",children:(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6 lg:gap-8",children:(0,r.jsxs)("div",{className:"text-center bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20 shadow-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-white",children:"買賣建議"}),(0,r.jsx)("div",{className:"text-blue-200 text-sm font-medium",children:"Trade Signals"})]})})})]})})]}),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto py-10 px-4",children:[(0,r.jsxs)("form",{className:"flex flex-col sm:flex-row gap-3 mb-6",onSubmit:e=>{e.preventDefault(),b||T()},children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"text",className:"w-full border-2 border-indigo-200 rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"輸入股票代號 (如 2330 or 0050)",value:e,onChange:e=>t(e.target.value),maxLength:10,autoFocus:!0})}),(0,r.jsxs)("select",{value:s,onChange:e=>g(e.target.value),className:"px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",children:[(0,r.jsx)("option",{value:"1d",children:"\uD83D\uDCCA 日線"}),(0,r.jsx)("option",{value:"1h",children:"⏰ 一小時"}),(0,r.jsx)("option",{value:"both",children:"\uD83D\uDCC8 兩者"})]}),(0,r.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",title:"選擇查詢的資料庫",children:[(0,r.jsx)("option",{value:"market_stock_tw",children:"\uD83C\uDDF9\uD83C\uDDFC market_stock_tw"}),(0,r.jsx)("option",{value:"market_stock_us",children:"\uD83C\uDDFA\uD83C\uDDF8 market_stock_us"}),(0,r.jsx)("option",{value:"market_crypto",children:"\uD83C\uDF10 market_crypto"}),(0,r.jsx)("option",{value:"market_forex",children:"\uD83D\uDCB1 market_forex"}),(0,r.jsx)("option",{value:"market_etf",children:"\uD83D\uDCCA market_etf"}),(0,r.jsx)("option",{value:"market_futures",children:"\uD83D\uDCC8 market_futures"}),(0,r.jsx)("option",{value:"market_index",children:"\uD83D\uDCC9 market_index"})]}),(0,r.jsx)("button",{type:"submit",className:"px-8 py-3 bg-gradient-to-r from-indigo-500 to-blue-500 text-white rounded-lg font-semibold hover:from-indigo-600 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105 active:scale-95 shadow-lg",disabled:b||!e,children:b?(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"查詢中..."]}):"\uD83D\uDD0D 查詢"})]}),j&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded-r-lg shadow-sm animate-pulse",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"text-red-500 text-xl",children:"⚠️"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-red-700 font-semibold mb-1",children:"查詢錯誤"}),(0,r.jsx)("div",{className:"text-sm text-red-600",children:j})]})]})}),(0,r.jsxs)("div",{ref:S,className:"space-y-6",children:[b&&(0,r.jsx)(u,{}),0===Object.keys(y).length&&!b&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-gray-400 text-lg mb-2",children:"\uD83D\uDD0D"}),(0,r.jsx)("div",{className:"text-gray-500",children:"尚未查詢，請輸入股票代號並按查詢。"})]}),!b&&Object.entries(y).map(t=>{let[s,a]=t;return(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-100 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4 flex-wrap gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:["1d"===s?"\uD83D\uDCCA":"⏰","1d"===s?"日線交易訊號":"小時線交易訊號"]}),(0,r.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:"1d"===s?"trade_signals_1d":"trade_signals_1h"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,r.jsxs)("div",{className:"px-3 py-2 bg-indigo-50 text-indigo-700 rounded-lg text-sm font-semibold",children:["共 ",a.length.toLocaleString()," 筆"]}),(0,r.jsxs)("button",{type:"button",className:"px-4 py-2 bg-white hover:bg-green-50 border border-green-200 rounded-lg text-sm inline-flex items-center gap-2 text-green-700 font-semibold shadow-sm transition-all hover:shadow",onClick:()=>(t=>{let s=function(e){if(!e||0===e.length)return"";let t=Object.keys(e[0]),s=[t.join(",")];for(let r of e){let e=t.map(e=>{let t=r[e];if(null==t)return"";let s=String(t).replace(/"/g,'""');return'"'.concat(s,'"')}).join(",");s.push(e)}return s.join("\n")}(y[t]||[]);if(!s)return;let r=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.download="".concat(e||"symbol","_").concat(h,"_").concat(t,"_trade_signals.csv"),document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(a)})(s),children:[(0,r.jsx)(i.a4x,{className:"text-base"}),"匯出 CSV"]}),(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-white hover:bg-gray-50 border rounded-lg text-sm font-semibold transition-all",onClick:()=>L(s,{visible:!k(s).visible}),children:k(s).visible?"\uD83D\uDC41️ 隱藏":"\uD83D\uDC41️ 顯示"})]})]}),a.length>0&&(e=>{let t=e.length,s=e[0],a=s&&(s.datetime||s.date)||"",l=s&&(s.close_price||s.close)||"",n=s?s.Trade_Signal:void 0,i=e.slice(0,40).map(e=>{var t;return Number(null!=(t=e.close_price)?t:e.close)||0}).filter(e=>e>0),c=i.length>0?i[i.length-1]:0,d=i.length>0?i[0]:0,u=c?(d-c)/c*100:0;return(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-4 mb-6 text-gray-800",children:[(0,r.jsxs)("div",{className:"sm:col-span-3 p-3 border rounded",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"總筆數"}),(0,r.jsx)("div",{className:"text-lg font-semibold",children:t.toLocaleString()})]}),(0,r.jsxs)("div",{className:"sm:col-span-3 p-3 border rounded",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"最新時間"}),(0,r.jsx)("div",{className:"text-sm",children:o(a)})]}),(0,r.jsxs)("div",{className:"sm:col-span-3 p-3 border rounded",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"當前訊號"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(m,{signal:n})})]}),(0,r.jsxs)("div",{className:"sm:col-span-3 p-3 border rounded",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"最新收盤價"}),(0,r.jsx)("div",{className:"text-sm font-medium",children:l?"NT$ ".concat(x(l)):"-"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:u?"".concat(u.toFixed(2),"%"):"-"})]})]})})(a),a.length>0&&(()=>{let e=M(a),t=Object.entries(e.counts).sort((e,t)=>t[1]-e[1]);return(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 border rounded bg-white shadow-sm sm:col-span-1",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:"訊號分布"}),0===t.length?(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"無"}):(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>{let[t,s]=e,a=d(String(t));return(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full border text-sm",children:[(0,r.jsx)("span",{className:"".concat(a.cls," px-2 py-0.5 rounded-full text-xs"),children:a.text}),(0,r.jsx)("span",{className:"text-gray-600 text-xs",children:s})]},t)})})]}),(0,r.jsxs)("div",{className:"p-4 border rounded bg-white shadow-sm sm:col-span-2",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:"指標出現次數（前200筆）"}),0===e.indicatorsSorted.length?(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"無"}):(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:e.indicatorsSorted.slice(0,12).map(e=>{let[t,s]=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between px-2 py-1 rounded",children:[(0,r.jsx)("div",{className:"text-gray-700",children:t}),(0,r.jsx)("div",{className:"text-blue-600 font-semibold",children:s})]},t)})})]}),(0,r.jsxs)("div",{className:"p-4 border rounded bg-white shadow-sm sm:col-span-3",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:"最近訊號時間線"}),0===e.timeline.length?(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"無"}):(0,r.jsx)("div",{className:"space-y-2 max-h-48 overflow-auto",children:e.timeline.slice(0,8).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 w-48 truncate",children:e.date}),(0,r.jsx)("div",{className:"flex-1 text-sm text-gray-700",children:e.price}),(0,r.jsx)("div",{className:"ml-2",children:(0,r.jsx)(m,{signal:e.signal})})]},t))})]})]})})(),0===a.length?(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"查無資料"}):k(s).visible&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[(0,r.jsx)("input",{type:"search",placeholder:"搜尋列（含 signal / datetime / price）",className:"border rounded px-3 py-2 text-sm w-64 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:k(s).search,onChange:e=>L(s,{search:e.target.value,page:1})}),(0,r.jsx)("label",{className:"text-sm text-gray-500",children:"每頁"}),(0,r.jsx)("select",{value:k(s).pageSize,className:"border rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",onChange:e=>L(s,{pageSize:Number(e.target.value),page:1}),children:[10,20,50,100].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(()=>{let e=k(s),t=e.search.trim().toLowerCase(),l=t?a.filter(e=>Object.values(e).some(e=>String(null!=e?e:"").toLowerCase().includes(t))):a,n=C?[...l].sort((e,t)=>{let s=e[C],r=t[C],a=Number(s),l=Number(r);if(!isNaN(a)&&!isNaN(l))return"asc"===O?a-l:l-a;let n=String(null!=s?s:"").toLowerCase(),i=String(null!=r?r:"").toLowerCase();return n<i?"asc"===O?-1:1:n>i?"asc"===O?1:-1:0}):l,i=Math.max(1,Math.ceil(n.length/e.pageSize)),c=(Math.min(Math.max(1,e.page),i)-1)*e.pageSize,u=Math.min(c+e.pageSize,n.length),m=n.slice(c,u),g=Object.keys(a[0]||{}),h=["datetime","date","signal","strength","price","close"],p=[...h.filter(e=>g.includes(e)),...g.filter(e=>!h.includes(e))];return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("table",{className:"w-full table-auto text-sm bg-white border",children:[(0,r.jsx)("thead",{children:(0,r.jsx)("tr",{className:"text-left bg-white border-b",children:p.map(e=>(0,r.jsx)("th",{className:"px-3 py-2 text-xs text-gray-600 font-medium cursor-pointer select-none",onClick:()=>(e=>{C===e?D("asc"===O?"desc":"asc"):(_(e),D("desc"))})(e),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:e}),C===e&&(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"asc"===O?"▲":"▼"})]})},e))})}),(0,r.jsx)("tbody",{children:m.map((e,s)=>(0,r.jsx)("tr",{className:"odd:bg-gray-50 hover:bg-gray-100",children:p.map(s=>{let a=e[s];if("datetime"===s||"date"===s)return(0,r.jsx)("td",{className:"px-3 py-2 align-top text-xs text-gray-700",children:o(a)},s);if("signal"===s||"Trade_Signal"===s){let e=d(String(a||""));return(0,r.jsx)("td",{className:"px-3 py-2 align-top",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs border ".concat(e.cls),children:e.text})},s)}return"price"===s||"close"===s||"close_price"===s?(0,r.jsx)("td",{className:"px-3 py-2 align-top font-medium text-gray-800",children:a?"NT$ ".concat(x(a)):"-"},s):(0,r.jsx)("td",{className:"px-3 py-2 align-top text-gray-700",children:(e=>{let s=null==e?"":String(e);if(!t)return s||"-";let a=s.toLowerCase().indexOf(t);return -1===a?s||"-":(0,r.jsxs)(r.Fragment,{children:[s.substring(0,a),(0,r.jsx)("mark",{className:"bg-yellow-100",children:s.substring(a,a+t.length)}),s.substring(a+t.length)]})})(a)},s)})},s))})]})})})()}),(()=>{let e=k(s),t=e.search.trim().toLowerCase(),l=t?a.filter(e=>Object.values(e).some(e=>String(null!=e?e:"").toLowerCase().includes(t))):a,n=C?[...l].sort((e,t)=>{let s=e[C],r=t[C],a=Number(s),l=Number(r);if(!isNaN(a)&&!isNaN(l))return"asc"===O?a-l:l-a;let n=String(null!=s?s:"").toLowerCase(),i=String(null!=r?r:"").toLowerCase();return n<i?"asc"===O?-1:1:n>i?"asc"===O?1:-1:0}):l,i=Math.max(1,Math.ceil(n.length/e.pageSize)),c=Math.min(Math.max(1,e.page),i),o=(c-1)*e.pageSize,d=Math.min(o+e.pageSize,n.length);return n.length>e.pageSize&&(0,r.jsxs)("div",{className:"flex items-center justify-between mt-3 px-2",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["顯示 ",o+1," - ",d," / ",n.length]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",className:"px-2 py-1 border rounded text-sm disabled:opacity-50",disabled:1===c,onClick:()=>L(s,{page:c-1}),children:"上一頁"}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["第 ",c," / ",i," 頁"]}),(0,r.jsx)("button",{type:"button",className:"px-2 py-1 border rounded text-sm disabled:opacity-50",disabled:c===i,onClick:()=>L(s,{page:c+1}),children:"下一頁"})]})]})})()]})]},s)})]})]}),(0,r.jsx)(l.A,{})]})}}},e=>{e.O(0,[938,141,636,593,792],()=>e(e.s=992)),_N_E=e.O()}]);