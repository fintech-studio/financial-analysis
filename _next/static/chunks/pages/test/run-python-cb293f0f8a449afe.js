(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{228:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/test/run-python",function(){return s(2135)}])},2135:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var l=s(7876),n=s(4232);let r=()=>{let[e,t]=(0,n.useState)(""),[s,r]=(0,n.useState)([]),[a,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),i=(0,n.useRef)(null);return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center pt-8 pb-16",children:(0,l.jsxs)("div",{className:"w-full max-w-4xl bg-white rounded-2xl shadow-lg p-8 border border-blue-100",children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-blue-800 mb-2 text-center",children:"Python 腳本測試"}),(0,l.jsxs)("p",{className:"text-blue-500 text-center mb-8 text-base",children:["獲取指定金融數據，並存入SQL SERVER。",(0,l.jsx)("a",{href:"https://github.com/HaoXun97/technical-indicators",className:"text-blue-500 underline",target:"_blank",rel:"noopener noreferrer",children:"程式碼"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"請輸入股票代號",className:"flex-1 px-4 py-2 rounded-lg border border-blue-200 focus:ring-2 focus:ring-blue-200 focus:outline-none text-lg bg-blue-50 placeholder-blue-300 text-blue-900 shadow-sm",disabled:a}),(0,l.jsx)("button",{onClick:()=>{r([]),d(""),o(!0),i.current&&i.current.close();let t=new EventSource("/api/test/run-python?symbol=".concat(encodeURIComponent(e)));i.current=t,t.onmessage=e=>{r(t=>[...t,e.data])},t.onerror=e=>{d("串流連線錯誤或執行失敗"),o(!1),t.close()},t.addEventListener("end",e=>{r(t=>[...t,e.data]),o(!1),t.close()})},disabled:a||!e,className:"px-6 py-2 rounded-lg font-semibold text-white text-lg transition-all duration-200 shadow-md ".concat(a||!e?"bg-blue-200 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),children:a?(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"執行中..."]}):"執行 Python"})]}),(0,l.jsx)("div",{className:"flex items-center gap-2 mb-6 flex-wrap",children:Object.entries({"--help":"顯示說明","--indicators-only":"重新計算指標","--expand-history":"獲取歷史","--show-all-stats":"顯示統計"}).map(e=>{let[s,n]=e;return(0,l.jsxs)("button",{type:"button",className:"px-3 py-1 rounded bg-blue-100 text-blue-700 font-semibold border border-blue-200 hover:bg-blue-200 transition text-sm",onClick:()=>t(s),disabled:a,children:[s," ",(0,l.jsxs)("span",{className:"text-xs text-blue-400 ml-1",children:["(",n,")"]})]},s)})}),(0,l.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 min-h-[120px] text-blue-700 font-mono text-sm whitespace-pre-wrap shadow-inner border border-blue-200",children:[0===s.length&&!c&&(0,l.jsx)("span",{className:"text-blue-300",children:"輸出結果將顯示於此..."}),s.map((e,t)=>(0,l.jsx)("div",{children:e},t)),c&&(0,l.jsxs)("div",{className:"text-red-500 font-semibold mt-2",children:["錯誤：",c]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(228)),_N_E=e.O()}]);