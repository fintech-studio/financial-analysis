(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[199],{454:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/test/trade-signals",function(){return t(8182)}])},8182:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});var l=t(7876),d=t(4232);let a=()=>{var e,s;let[t,a]=(0,d.useState)(""),[r,i]=(0,d.useState)(!1),[n,c]=(0,d.useState)(""),[x,o]=(0,d.useState)(null),m=(0,d.useRef)(null),g=async()=>{i(!0),c(""),o(null);try{let e=await fetch("/api/test/trade-signals?symbol=".concat(encodeURIComponent(t))),s=await e.json();if(e.ok&&s.success)o(s.data);else{let l=s.error||"分析失敗";404===e.status?l='找不到股票代號 "'.concat(t,'" 的資料\n\n').concat(s.details||"","\n\n建議：\n• 確認股票代號格式是否正確\n• 嘗試其他股票代號\n• 聯繫管理員確認資料庫狀態"):400===e.status?l="請求參數錯誤：".concat(l):500===e.status?l="伺服器內部錯誤：".concat(l,"\n\n請稍後再試，或聯繫技術支援"):l.includes("找不到")||l.includes("沒有資料")?l='找不到股票代號 "'.concat(t,'" 的資料，請確認：\n• 股票代號是否正確\n• 該股票是否已上市\n• 資料庫是否包含此股票的歷史資料'):l.includes("無法解析")?l="分析結果解析失敗，可能是資料格式問題":l.includes("連線")&&(l="資料庫連線失敗，請稍後再試"),c(l)}}catch(s){let e="網路連線失敗";s instanceof Error&&(e=s.message.includes("fetch")?"無法連接到伺服器，請檢查網路連線":s.message.includes("timeout")?"請求逾時，請稍後再試":"網路錯誤：".concat(s.message)),c(e)}finally{i(!1)}};(0,d.useEffect)(()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},[x]);let h=e=>e.includes("買入")?"text-green-600 bg-green-50":e.includes("賣出")?"text-red-600 bg-red-50":"text-gray-600 bg-gray-50",u=e=>e.includes("買入")?"\uD83D\uDCC8":e.includes("賣出")?"\uD83D\uDCC9":"\uD83D\uDCCA";return(0,l.jsxs)("div",{className:"max-w-6xl mx-auto py-10 px-4",children:[(0,l.jsxs)("button",{type:"button",className:"mb-6 px-4 py-2 bg-white hover:bg-indigo-50 text-indigo-600 border border-indigo-200 rounded-lg text-base font-semibold shadow-sm flex items-center gap-2 transition-all duration-200",onClick:()=>window.history.back(),children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),"返回上一頁"]}),(0,l.jsx)("h1",{className:"text-4xl font-bold mb-6 text-center flex items-center justify-center gap-2",children:"進階交易訊號分析"}),(0,l.jsx)("p",{className:"text-center text-gray-500 mb-6",children:"只先做台股而已\uD83D\uDCA4"}),(0,l.jsxs)("form",{className:"flex flex-col sm:flex-row gap-2 mb-8 items-center justify-center",onSubmit:e=>{e.preventDefault(),!r&&t&&g()},children:[(0,l.jsx)("input",{type:"text",className:"flex-1 border-2 border-indigo-200 rounded-lg px-4 py-2 text-lg focus:ring-2 focus:ring-indigo-400 outline-none shadow-sm transition-all duration-200 min-w-[180px]",placeholder:"請輸入股票代號 (如 2330)",value:t,onChange:e=>a(e.target.value.replace(/[^0-9A-Za-z]/g,"")),disabled:r,maxLength:10,autoFocus:!0}),(0,l.jsx)("button",{type:"submit",className:"w-32 px-5 py-2 bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-600 hover:to-blue-600 text-white rounded-lg text-lg font-semibold disabled:opacity-60 text-center shadow-md transition-all duration-200",disabled:!t||r,children:r?"分析中...":"分析"})]}),n&&(0,l.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,l.jsx)("div",{className:"text-red-700 font-medium mb-2",children:n.includes("找不到")?"\uD83D\uDCCB 查無資料":"❌ 分析失敗"}),(0,l.jsx)("div",{className:"text-red-600 text-sm whitespace-pre-line",children:n}),n.includes("找不到")&&(0,l.jsxs)("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded text-sm",children:[(0,l.jsx)("div",{className:"text-yellow-700 font-medium mb-1",children:"\uD83D\uDCA1 常見股票代號範例"}),(0,l.jsxs)("div",{className:"text-yellow-600 space-y-1",children:[(0,l.jsx)("div",{children:"• 台積電：2330"}),(0,l.jsx)("div",{children:"• 聯發科：2454"}),(0,l.jsx)("div",{children:"• 鴻海：2317"}),(0,l.jsx)("div",{children:"• 台達電：2308"}),(0,l.jsx)("div",{children:"• 元大台灣50：0050"})]})]}),n.includes("伺服器內部錯誤")&&(0,l.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded text-sm",children:[(0,l.jsx)("div",{className:"text-blue-700 font-medium mb-1",children:"\uD83D\uDD27 故障排除"}),(0,l.jsxs)("div",{className:"text-blue-600",children:["• 稍等幾分鐘後重新嘗試",(0,l.jsx)("br",{}),"• 如問題持續，請聯繫技術支援",(0,l.jsx)("br",{}),"• 錯誤時間：",new Date().toLocaleString()]})]})]}),r&&(0,l.jsx)("div",{className:"mb-6 p-8 bg-indigo-50 border border-indigo-200 rounded-lg text-center",children:(0,l.jsxs)("div",{className:"inline-flex items-center gap-3",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600"}),(0,l.jsx)("span",{className:"text-indigo-700 font-medium",children:"正在分析交易訊號..."})]})}),x&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-blue-700 font-medium",children:"總資料筆數"}),(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:x.summary.totalRecords.toLocaleString()}),(0,l.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"來自資料庫的股票K線資料總筆數"})]}),(0,l.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-green-700 font-medium",children:"有訊號筆數"}),(0,l.jsx)("div",{className:"text-2xl font-bold text-green-800",children:x.summary.signalRecords.toLocaleString()}),(0,l.jsx)("div",{className:"text-xs text-green-600 mt-1",children:"觸發買賣訊號的資料筆數"})]}),(0,l.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-purple-700 font-medium",children:"訊號覆蓋率"}),(0,l.jsxs)("div",{className:"text-2xl font-bold text-purple-800",children:[x.summary.signalPercentage.toFixed(1),"%"]}),(0,l.jsx)("div",{className:"text-xs text-purple-600 mt-1",children:"有訊號筆數 \xf7 總資料筆數 \xd7 100"})]})]}),x.latestData&&(0,l.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 border border-indigo-200 rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-4 text-indigo-800",children:"\uD83D\uDD04 最新資料狀態"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"最新日期"}),(0,l.jsx)("div",{className:"text-lg font-bold text-gray-800",children:x.latestData.date})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"收盤價"}),(0,l.jsxs)("div",{className:"text-lg font-bold text-gray-800",children:["NT$ ",x.latestData.price.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"當前訊號"}),(0,l.jsx)("div",{className:"text-lg font-bold ".concat(h(x.latestData.signal).split(" ")[0]),children:x.latestData.signal||"無訊號"})]})]}),x.latestData.signal&&(0,l.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"訊號強度"}),(0,l.jsx)("div",{className:"text-base font-medium text-gray-700",children:x.latestData.strength})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"多頭分數"}),(0,l.jsx)("div",{className:"text-base font-bold text-green-600",children:x.latestData.buySignals.toFixed(1)})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"空頭分數"}),(0,l.jsx)("div",{className:"text-base font-bold text-red-600",children:x.latestData.sellSignals.toFixed(1)})]})]})]}),(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:"\uD83D\uDCCA 交易訊號統計"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:Object.entries(x.signals).map(e=>{let[s,t]=e;return(0,l.jsxs)("div",{className:"p-3 rounded-lg border ".concat(h(s)),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,l.jsx)("span",{children:u(s)}),(0,l.jsx)("span",{className:"font-medium text-sm",children:s})]}),(0,l.jsxs)("div",{className:"text-lg font-bold",children:[t.count,"次"]}),(0,l.jsxs)("div",{className:"text-xs opacity-75",children:[t.percentage.toFixed(2),"%"]})]},s)})})]}),(x.strength.buyAverage||x.strength.sellAverage)&&(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:"\uD83D\uDCAA 訊號強度分析"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.strength.buyAverage&&(0,l.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-green-700 font-medium mb-2",children:"\uD83D\uDFE2 多頭訊號強度"}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{children:["平均:"," ",(0,l.jsxs)("span",{className:"font-bold",children:[x.strength.buyAverage.toFixed(1),"分"]})]}),(0,l.jsxs)("div",{children:["最高:"," ",(0,l.jsxs)("span",{className:"font-bold",children:[null==(e=x.strength.buyMax)?void 0:e.toFixed(1),"分"]})]})]})]}),x.strength.sellAverage&&(0,l.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,l.jsx)("div",{className:"text-red-700 font-medium mb-2",children:"\uD83D\uDD34 空頭訊號強度"}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{children:["平均:"," ",(0,l.jsxs)("span",{className:"font-bold",children:[x.strength.sellAverage.toFixed(1),"分"]})]}),(0,l.jsxs)("div",{children:["最高:"," ",(0,l.jsxs)("span",{className:"font-bold",children:[null==(s=x.strength.sellMax)?void 0:s.toFixed(1),"分"]})]})]})]})]})]}),x.recentSignals.length>0&&(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:"⏰ 最近交易訊號"}),(0,l.jsx)("div",{className:"space-y-3",children:x.recentSignals.map((e,s)=>(0,l.jsx)("div",{className:"p-3 rounded-lg border ".concat(h(e.signal)),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{children:u(e.signal)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium",children:e.signal}),(0,l.jsx)("div",{className:"text-sm opacity-75",children:e.strength})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"font-medium",children:e.date}),e.price>0&&(0,l.jsxs)("div",{className:"text-sm opacity-75",children:["NT$ ",e.price]})]})]})},s))})]})]}),!r&&!x&&!n&&(0,l.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCC8"}),(0,l.jsx)("div",{className:"text-lg",children:"請輸入股票代號並點擊分析開始"})]})]})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=454)),_N_E=e.O()}]);