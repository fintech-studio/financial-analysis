(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{1539:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(7876);s(4232);var r=s(7021),l=s(9038);let n=()=>(0,a.jsxs)("footer",{className:"bg-gray-900 text-gray-300 relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 opacity-5",children:(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-blue-500/20 to-purple-500/20"})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 relative z-10 pt-12",children:[(0,a.jsxs)("div",{className:"grid lg:grid-cols-4 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mr-4",children:(0,a.jsx)(r.A,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-white",children:"FinTech Studio"}),(0,a.jsx)("p",{className:"text-gray-400",children:"智慧金融分析平台"})]})]}),(0,a.jsx)("p",{className:"text-gray-400 leading-relaxed mb-6 max-w-md",children:"金融走勢智慧分析，讓投資更簡單。透過 AI 技術，提供即時市場分析、訊號分析和交易建議，助您做出明智的投資決策。"}),(0,a.jsx)("div",{className:"flex space-x-4",children:(0,a.jsx)("a",{href:"https://github.com/fintech-studio/financial-analysis",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center transition-colors group",children:(0,a.jsx)(l.hL4,{className:"w-5 h-5 text-gray-400 group-hover:text-white transition-colors"})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-white font-semibold mb-6",children:"功能"}),(0,a.jsx)("ul",{className:"space-y-3",children:["市場分析","財經新聞","AI 預測","AI 助理"].map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:["/market-analysis","/news","/predict","/chat"][["市場分析","財經新聞","AI 預測","AI 助理"].indexOf(e)],className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-white font-semibold mb-6",children:"支援"}),(0,a.jsx)("ul",{className:"space-y-3",children:["幫助中心","聯絡我們","隱私政策","服務條款"].map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:e})},e))})]})]}),(0,a.jsx)("div",{className:"border-t border-gray-800 mt-8 pt-8 flex flex-col md:flex-row items-center justify-center",children:(0,a.jsxs)("p",{className:"text-gray-400 text-sm text-center",children:["\xa9 ",new Date().getFullYear()," FinTech Studio. All rights reserved."]})})]})]})},2283:(e,t,s)=>{"use strict";s.d(t,{B:()=>r});var a=s(6971);class r extends a.d{static getInstance(){return r.instance||(r.instance=new r),r.instance}logInfo(e,t){this.enableLog&&console.log("[DatabaseService] ".concat(e),t||"")}logError(e,t){this.enableLog&&console.error("[DatabaseService] ".concat(e),t||"")}getApiBaseUrl(){return window.location.origin}extractError(e){return e.error||e.message||"操作失敗"}validateConnectionConfig(e){if(!e.server)throw Error("伺服器地址不能為空");if(!e.user||!e.password)throw Error("SQL Server 驗證模式需要提供用戶名和密碼")}async testConnection(e){try{this.logInfo("開始測試數據庫連接",{server:e.server,database:e.database||"預設",user:e.user}),this.validateConnectionConfig(e);let t=this.getApiBaseUrl(),s=await fetch("".concat(t,"/api/database/test-connection"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await s.json();if(a.success)return this.logInfo("數據庫連接測試成功",a.message),a;return this.logError("數據庫連接測試失敗",a.message),a}catch(e){return this.logError("數據庫連接測試發生錯誤",e),{success:!1,message:"連接失敗：".concat(e instanceof Error?e.message:"網路錯誤")}}}async executeQuery(e,t,s){try{var a,r;if(this.logInfo("開始執行 SQL 查詢",{query:t.substring(0,100)+"..."}),!t||!t.trim())return{success:!1,error:"SQL 查詢語句不能為空"};let l=this.getApiBaseUrl(),n=await fetch("".concat(l,"/api/database/execute-query"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:e,query:t,params:s})}),i=await n.json();if(!i.success)return this.logError("SQL 查詢執行失敗",this.extractError(i)),{success:!1,error:this.extractError(i)};return this.logInfo("SQL 查詢執行成功",{recordCount:(null==(a=i.data)?void 0:a.length)||0}),{success:!0,data:i.data||[],count:(null==(r=i.data)?void 0:r.length)||0,message:i.message}}catch(e){return this.logError("SQL 查詢執行發生錯誤",e),{success:!1,error:"查詢失敗：".concat(e instanceof Error?e.message:"網路錯誤")}}}async getTableList(e){try{this.logInfo("開始獲取數據庫表列表");let t=await this.executeQuery(e,"SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' ORDER BY TABLE_NAME");if(t.success&&t.data){let e=t.data.map(e=>e.TABLE_NAME);return this.logInfo("成功獲取表列表",{tableCount:e.length}),e}{let e=this.extractError(t);if(e.includes("登入失敗"))return this.logError("登入失敗：請檢查使用者名稱、密碼，或確認帳號是否有存取該資料庫的權限。如有疑問請聯絡資料庫管理員。",e),[];return this.logError("獲取表列表失敗",e),[]}}catch(e){return this.logError("獲取表列表失敗",e),[]}}async getTableSchema(e,t){try{this.logInfo("開始獲取表結構",{tableName:t});let s=await this.executeQuery(e,"SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE, COLUMN_DEFAULT, CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @tableName ORDER BY ORDINAL_POSITION",{tableName:t});if(s.success&&s.data)return this.logInfo("成功獲取表結構",{columnCount:s.data.length}),s.data;throw Error(this.extractError(s))}catch(e){throw this.logError("獲取表結構失敗",e),Error(e instanceof Error?e.message:"獲取表結構失敗")}}async getDatabaseList(e){try{this.logInfo("開始獲取資料庫列表");let t={...e,database:"master"},s=await this.executeQuery(t,"SELECT name FROM sys.databases WHERE database_id > 4 ORDER BY name");if(s.success&&s.data){let e=s.data.map(e=>e.name);return this.logInfo("成功獲取資料庫列表",{databaseCount:e.length}),e}throw Error(this.extractError(s))}catch(e){throw this.logError("獲取資料庫列表失敗",e),Error(e instanceof Error?e.message:"獲取資料庫列表失敗")}}constructor(){super(),this.enableLog=!0}}},4316:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(4232);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))})},5325:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(4232);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z"}))})},5765:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(4232);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))})},6770:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(7876),r=s(4232),l=s(7021),n=s(7043);let i=r.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))});var c=s(5325);let o=r.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))}),d=r.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}),x=r.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))});var h=s(3393),m=s(1539),u=s(1290),g=s(8787),b=s(5765),p=s(4316),f=s(2525),v=s(8616);let j=e=>{let{data:t,title:s="趨勢圖",height:l=500,theme:n="light",showBothLines:i=!1}=e,c=(0,r.useRef)(null),o=(0,r.useRef)(null),d=(0,r.useRef)(null),x=(0,r.useRef)(null),[h,m]=(0,r.useState)(!1),[j,N]=(0,r.useState)(null),[y,w]=(0,r.useState)(null),[E,k]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(console.log("Chart initialization - data:",null==t?void 0:t.length),!c.current)return void console.error("Chart container is null");if(!(null==t?void 0:t.length))return void console.error("No data provided");let e="dark"===n;try{o.current&&(console.log("Removing old chart"),o.current.remove(),o.current=null),console.log("Creating chart with container width:",c.current.clientWidth);let s=(0,u.R9)(c.current,{layout:{background:{type:u.mE.Solid,color:e?"#1f2937":"#ffffff"},textColor:e?"#e5e7eb":"#374151"},width:c.current.clientWidth||800,height:h?window.innerHeight-200:l,grid:{vertLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},horzLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},crosshair:{mode:1},rightPriceScale:{borderColor:e?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)"},timeScale:{borderColor:e?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",timeVisible:!0,secondsVisible:!1},localization:{locale:"zh-TW"}});o.current=s,console.log("Chart created successfully");let a=[],r=[];if(t.forEach((e,t)=>{let s=e.date.includes("T")?Math.floor(new Date(e.date).getTime()/1e3):e.date.split("T")[0];console.log("Processing data point ".concat(t,":"),{date:e.date,timeValue:s,value:e.value,predictValue:e.predictValue}),null==e.value||isNaN(Number(e.value))||a.push({time:s,value:Number(e.value)}),i&&null!=e.predictValue&&!isNaN(Number(e.predictValue))&&r.push({time:s,value:Number(e.predictValue)})}),console.log("Processed data:",{lineData:a.length,predictData:r.length}),E&&a.length>0){let e=s.addSeries(u.Im,{color:"#3b82f6",lineWidth:3,priceLineVisible:!1,lastValueVisible:!1,crosshairMarkerVisible:!0,crosshairMarkerRadius:6});console.log("Setting main line data:",a.length,"points"),e.setData(a),d.current=e}if(i&&r.length>0){let e=s.addSeries(u.Im,{color:"#10b981",lineWidth:2,priceLineVisible:!1,lastValueVisible:!1,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,lineStyle:2});console.log("Setting predict line data:",r.length,"points"),e.setData(r),x.current=e}s.subscribeCrosshairMove(e=>{if(e&&e.time&&e.point){let s=e.time.toString(),a=t.find(e=>(e.date.includes("T")?Math.floor(new Date(e.date).getTime()/1e3).toString():e.date.split("T")[0])===s);a?(N(a),w({x:e.point.x,y:e.point.y})):(N(null),w(null))}else N(null),w(null)}),s.timeScale().fitContent(),console.log("Chart initialization completed successfully")}catch(e){console.error("Chart initialization error:",e)}return()=>{o.current&&(o.current.remove(),o.current=null),d.current=null,x.current=null}},[t,n,l,h,E,i]),(0,r.useEffect)(()=>{let e=()=>{o.current&&c.current&&o.current.applyOptions({width:c.current.clientWidth,height:h?window.innerHeight-180:l})};if(h)return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[h,l]),(0,r.useEffect)(()=>{h&&window.scrollTo({top:0,behavior:"smooth"})},[h]);let S=e=>{let t=new Date(e);if(isNaN(t.getTime()))return e;let s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),l=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return"00"===l&&"00"===n?"".concat(s,"/").concat(a,"/").concat(r):"".concat(s,"/").concat(a,"/").concat(r," ").concat(l,":").concat(n)};return(console.log("Render - data length:",null==t?void 0:t.length,"chart ref exists:",!!o.current),null==t?void 0:t.length)?(0,a.jsxs)("div",{className:"relative bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden ".concat(h?"fixed inset-0 z-[9999] m-0 rounded-none shadow-lg":""),children:[(0,a.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,a.jsx)(g.A,{className:"h-5 w-5 text-gray-600"})}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:s}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[t.length," 個預測點 • ",(()=>{if(!(null==t?void 0:t.length))return"--";let e=S(t[0].date),s=S(t[t.length-1].date);return"".concat(e," ~ ").concat(s)})()]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2 bg-white border border-gray-200 rounded-lg px-3 py-2",children:(0,a.jsxs)("button",{onClick:()=>k(!E),className:"flex items-center space-x-1 px-2 py-1 rounded text-xs transition-colors ".concat(E?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"),children:[E?(0,a.jsx)(b.A,{className:"h-3 w-3"}):(0,a.jsx)(p.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"預測值"})]})}),(0,a.jsx)("button",{onClick:()=>m(!h),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",title:h?"退出全屏":"進入全屏",children:h?(0,a.jsx)(f.A,{className:"h-4 w-4"}):(0,a.jsx)(v.A,{className:"h-4 w-4"})})]})]})}),(0,a.jsxs)("div",{className:"p-4 relative",children:[j&&y&&(0,a.jsxs)("div",{className:"absolute z-10 bg-white/95 border border-gray-200 rounded-lg shadow-lg px-4 py-3 text-sm text-gray-800 pointer-events-none",style:{left:"calc(".concat(y.x,"px + 20px)"),top:"calc(".concat(y.y,"px - 10px)"),minWidth:"180px"},children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 mb-2",children:S(j.date)}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:i?"真實值:":"預測值:"}),(0,a.jsx)("span",{className:"font-medium text-blue-600",children:j.value.toFixed(4)})]}),i&&void 0!==j.predictValue&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"預測值:"}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:j.predictValue.toFixed(4)})]})]})]}),(0,a.jsx)("div",{ref:c,style:{height:h?"calc(100vh - 150px)":"".concat(l,"px"),width:"100%",minHeight:"400px"},className:"bg-white rounded border border-gray-100"})]}),(0,a.jsx)("div",{className:"bg-gray-50 px-6 py-2 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["預測點數: ",t.length]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[E&&(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-3 h-0.5 bg-blue-600 mr-1"}),i?"真實值":"預測值"]}),i&&(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-3 h-0.5 bg-green-600 mr-1"}),"預測值"]})]}),(0,a.jsx)("div",{className:"text-center text-[12px] select-none",children:"Powered by TradingView Lightweight Charts"})]})})]}):(0,a.jsx)("div",{className:"flex items-center justify-center bg-white rounded-lg border border-gray-200 shadow-sm",style:{height:"".concat(l,"px")},children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(g.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"暫無圖表數據"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"請提供有效的預測數據"})]})})};var N=s(2283);let y=()=>{var e,t,s,u,g;let[b,p]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),[y,w]=(0,r.useState)(!1),[E,k]=(0,r.useState)(""),[S,C]=(0,r.useState)("US"),[A,L]=(0,r.useState)("AAPL"),[T,M]=(0,r.useState)(192),[_,O]=(0,r.useState)(12),R=[{value:"US",label:"美國",flag:"\uD83C\uDDFA\uD83C\uDDF8",db:"market_stock_us"},{value:"TW",label:"台灣",flag:"\uD83C\uDDF9\uD83C\uDDFC",db:"market_stock_tw"},{value:"CRYPTO",label:"加密貨幣",flag:"₿",db:"market_crypto"}],[I,H]=(0,r.useState)({server:"",user:"",password:"",database:"",port:void 0,options:{}}),[D,B]=(0,r.useState)(!1),[V,P]=(0,r.useState)(!1),[W,U]=(0,r.useState)([]),F=(0,r.useMemo)(()=>N.B.getInstance(),[]),z=(0,r.useCallback)(async()=>{P(!0),k("");try{let e=window.location.origin,t=await fetch("".concat(e,"/api/database/test-connection"),{method:"GET"}),s=await t.json();s.success?(B(!0),k(""),console.log("資料庫連接成功:",s.message)):(B(!1),k(s.message))}catch(e){B(!1),k(e instanceof Error?e.message:"連接失敗")}finally{P(!1)}},[I]),Y=(0,r.useCallback)(async()=>{if(!D)return void k("請先連接資料庫");if(!A.trim())return void k("請輸入股票代碼");P(!0),k("");try{let e=await F.executeQuery(I,"\n        SELECT TOP 10000\n          close_price\n        FROM ".concat("stock_data_1h","\n        WHERE symbol = @symbol\n        ORDER BY datetime DESC\n      "),{symbol:A.toUpperCase()});if(e.success&&e.data){let t=e.data.map(e=>e.close_price);U(t)}else k(e.error||"找不到 ".concat(A," 的資料"))}catch(e){k(e instanceof Error?e.message:"查詢失敗")}finally{P(!1)}},[D,A,I,F]),Q=(0,r.useCallback)(e=>{L(e)},[]),Z=(0,r.useCallback)(async e=>{w(!0),k(""),p(null),v(null);try{let t=await fetch("/api/py/stock_prediction/predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();if(!t.ok||s.detail)throw Error(s.detail||"HTTP error! status: ".concat(t.status));p(s)}catch(e){k(e instanceof Error?e.message:"預測失敗")}finally{w(!1)}},[]),G=(0,r.useCallback)(async e=>{w(!0),k(""),v(null),p(null);try{let t=await fetch("/api/py/stock_prediction/long_term_eval",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();if(!t.ok||s.detail)throw Error(s.detail||"HTTP error! status: ".concat(t.status));v(s)}catch(e){k(e instanceof Error?e.message:"評估失敗")}finally{w(!1)}},[]),J=(0,r.useCallback)(()=>{Z({data_numpy:W,context_length:T,prediction_length:_})},[W,T,_,Z]),X=(0,r.useCallback)(()=>{G({data_numpy:W,context_length:T,prediction_length:_})},[W,T,_,G]),q=(0,r.useCallback)(e=>{let t=new Date,s=[],a=e.mean;if(!Array.isArray(a)||0===a.length)return[];for(let e=0;e<a.length;e++){let r=new Date(t);r.setHours(r.getHours()+(e+1));let l=a[e];s.push({date:r.toISOString(),value:Number(l)||0})}return s},[]),K=(0,r.useCallback)(e=>{var t,s;let a=[];if(!(null==(t=e.true_value)?void 0:t.length)||!(null==(s=e.predict)?void 0:s.length))return[];let r=Array.isArray(e.true_value)?[...e.true_value]:[],l=Array.isArray(e.predict)?[...e.predict]:[],n=Math.max(r.length,l.length),i=new Date;i.setHours(i.getHours()-n);for(let e=0;e<n;e++){let t=new Date(i);t.setHours(t.getHours()+(e+1));let s=e<r.length?r[e]:0,n=e<l.length?l[e]:0;a.push({date:t.toISOString(),value:Number(s)||0,predictValue:Number(n)||0})}return a},[]),$=(0,r.useMemo)(()=>b?q(b):[],[b,q]),ee=(0,r.useMemo)(()=>f?K(f):[],[f,K]);return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("section",{className:"relative bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center overflow-hidden shadow-2xl",children:[(0,a.jsx)("div",{className:"absolute inset-0 opacity-20",children:(0,a.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"\n                linear-gradient(rgba(255,255,255,0.06) 1px, transparent 1px),\n                linear-gradient(90deg, rgba(255,255,255,0.06) 1px, transparent 1px)\n              ",backgroundSize:"60px 60px"}})}),(0,a.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full",children:[(0,a.jsx)("div",{className:"absolute top-12 left-12 w-24 h-24 bg-white opacity-5 rounded-full animate-pulse"}),(0,a.jsx)("div",{className:"absolute bottom-12 right-24 w-36 h-36 bg-white opacity-5 rounded-full animate-pulse",style:{animationDelay:"1s"}}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-radial from-white/10 to-transparent rounded-full"}),(0,a.jsx)("div",{className:"absolute top-24 right-12 w-4 h-4 bg-white opacity-20 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"absolute bottom-24 left-24 w-3 h-3 bg-white opacity-30 rounded-full animate-pulse",style:{animationDelay:"1.5s"}})]}),(0,a.jsx)("div",{className:"relative max-w-7xl mx-auto px-6 sm:px-8 lg:px-12 py-16 z-10 w-full",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-8",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"p-4 bg-white/10 rounded-3xl backdrop-blur-sm mr-6 group hover:bg-white/20 transition-all duration-300 shadow-lg",children:(0,a.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,a.jsx)(l.A,{className:"h-8 w-8 text-white"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl lg:text-5xl font-bold text-white tracking-tight leading-tight",children:"股票預測分析"}),(0,a.jsx)("p",{className:"text-blue-100 mt-3 text-lg font-medium",children:"基於機器學習的股票價格預測模型"})]})]}),(0,a.jsx)("p",{className:"text-blue-100 text-lg max-w-3xl leading-relaxed",children:"使用真實歷史價格資料與 AI 模型，產生短期/中期價格走勢預測，並提供模型評估視覺化結果。"})]}),(0,a.jsx)("div",{className:"flex flex-col lg:items-end space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 lg:gap-8",children:[(0,a.jsxs)("div",{className:"text-center bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20 shadow-lg",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-white",children:"即時"}),(0,a.jsx)("div",{className:"text-blue-200 text-sm font-medium",children:"模型回饋"})]}),(0,a.jsxs)("div",{className:"text-center bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20 shadow-lg",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-white",children:"可視化"}),(0,a.jsx)("div",{className:"text-blue-200 text-sm font-medium",children:"趨勢圖表"})]})]})})]})})]}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,a.jsx)(n.A,{className:"w-6 h-6 text-blue-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"股票選擇"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"選擇市場"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4",children:R.map(e=>(0,a.jsxs)("button",{onClick:()=>{C(e.value),H({...I,database:e.db})},className:"flex items-center justify-center p-4 rounded-lg border-2 transition-all ".concat(S===e.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)("span",{className:"text-2xl mr-3",children:e.flag}),(0,a.jsx)("span",{className:"font-medium",children:e.label})]},e.value))})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["股票代碼","TW"===S&&(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"(例: 2330)"}),"US"===S&&(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"(例: AAPL)"}),"CRYPTO"===S&&(0,a.jsx)("span",{className:"text-gray-500 ml-1",children:"(例: BTC)"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("input",{type:"text",value:A,onChange:e=>L(e.target.value.toUpperCase()),className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"輸入".concat(null==(e=R.find(e=>e.value===S))?void 0:e.label,"股票代碼"),onKeyDown:e=>"Enter"===e.key&&Y()}),(0,a.jsxs)("button",{onClick:Y,disabled:!D||V||!A.trim(),className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg transition-colors flex items-center space-x-2",children:[(0,a.jsx)(n.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:V?"查詢中...":"查詢"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["熱門",null==(t=R.find(e=>e.value===S))?void 0:t.label,"股票"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:null==(s=({US:["AAPL","GOOGL","MSFT","AMZN","TSLA","META","NVDA","AMD"],TW:["2330","2317","2454","2881","6505","3008","2382","2303"],CRYPTO:["BTC-USD","SOL-USD","ETH-USD"]})[S])?void 0:s.map(e=>(0,a.jsx)("button",{onClick:()=>Q(e),className:"px-3 py-2 text-sm rounded-md transition-colors ".concat(A===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e},e))})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,a.jsx)(i,{className:"w-6 h-6 text-blue-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"預測參數"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Context Length"}),(0,a.jsx)("input",{type:"number",value:T,onChange:e=>M(parseInt(e.target.value)||192),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"192"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prediction Length"}),(0,a.jsx)("input",{type:"number",value:_,onChange:e=>O(parseInt(e.target.value)||12),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"12"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(i,{className:"w-6 h-6 text-blue-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"資料庫連接"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(D?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:D?"已連接":"未連接"})]})}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:z,disabled:V,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors",children:V?"連接中...":"測試連接"}),(0,a.jsx)("button",{onClick:Y,disabled:!D||V,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors",children:V?"查詢中...":"查詢股票資料"})]}),A&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["已選擇:"," ",(0,a.jsxs)("span",{className:"font-medium",children:[null==(u=R.find(e=>e.value===S))?void 0:u.flag," ",A]}),W.length>0&&(0,a.jsxs)("span",{className:"ml-3",children:["• 已載入 ",W.length," 筆資料，最新價格:"," ",null==(g=W[0])?void 0:g.toFixed(2)]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)("div",{className:"w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(l.A,{className:"w-12 h-12 text-gray-400"})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"股票預測模型"}),(0,a.jsx)("p",{className:"text-gray-600 leading-relaxed mb-6",children:W.length>0?"使用 ".concat(A," 的真實資料進行預測，查看未來的價格預測。"):"請先選擇股票並查詢資料，然後進行預測分析。"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)("button",{onClick:J,disabled:y||W.length<T,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-8 py-3 rounded-lg transition-colors text-lg font-medium",children:y?"預測中...":"預測 ".concat(A||"股票"," 價格")}),(0,a.jsx)("button",{onClick:X,disabled:y||W.length<T+_,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-8 py-3 rounded-lg transition-colors text-lg font-medium",children:y?"評估中...":"評估模型準確度"})]}),E&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)("p",{className:"text-red-700 font-medium",children:"錯誤："}),(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:E}),E.includes("shapes")&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-2",children:"這是後端模型維度問題，請檢查 Python 代碼中的矩陣計算邏輯"})]})]}),(b||f)&&(0,a.jsxs)("div",{className:"mt-8",children:[b&&!f&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4 text-center",children:"AI 預測結果"}),(0,a.jsx)(j,{data:$,title:"股票價格預測趨勢",height:600})]}),f&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4 text-center",children:"模型評估結果"}),(0,a.jsx)(j,{data:ee,title:"預測準確度評估 - 真實值 vs 預測值",height:600,showBothLines:!0})]})]})]})]}),(0,a.jsx)("div",{className:"bg-gray-50 pb-8",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:(0,a.jsx)(c.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"系統資訊"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(o,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"text-gray-600",children:"預測模型："}),(0,a.jsx)("span",{className:"ml-1 font-medium text-gray-900",children:"Chronos Forecasting"})]}),(0,a.jsx)("span",{className:"block mt-2 text-xs text-gray-500",children:"使用 LSTM、Transformer 等深度學習架構進行時間序列預測"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg mr-3",children:(0,a.jsx)(d,{className:"h-5 w-5 text-green-600"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"數據來源"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(x,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"text-gray-700",children:"歷史真實市場數據"})]}),(0,a.jsx)("span",{className:"block mt-2 text-xs text-gray-500",children:"資料來自 Yahoo Finance，包含股票與加密貨幣的歷史價格"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg mr-3",children:(0,a.jsx)(h.A,{className:"h-5 w-5 text-yellow-600"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"免責聲明"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 leading-relaxed",children:["本系統提供的分析僅供參考，投資決策請自行評估風險。",(0,a.jsx)("span",{className:"block mt-2 text-xs text-gray-500",children:"AI預測結果基於歷史數據分析，不保證未來表現。"})]})]})]})})})}),(0,a.jsx)(m.A,{})]})}},6929:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/predict",function(){return s(6770)}])}},e=>{e.O(0,[938,329,665,636,593,792],()=>e(e.s=6929)),_N_E=e.O()}]);